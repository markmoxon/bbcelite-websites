<?php
include_once("../../../templates/template_functions.php");
page_header("keyboard", "subroutine_processpausekeys.html", "The ProcessPauseKeys subroutine", "Keyboard: ProcessPauseKeys", "Annotated code for the ProcessPauseKeys subroutine in The Sentinel", "the_sentinel-code", "source_keyboard", "subroutine_processpausekeys", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/envelopevolumes.html">envelopeVolumes</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/processmusic.html">ProcessMusic</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">ProcessPauseKeys</span>                                        <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Keyboard</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Pause or unpause the game when COPY or DELETE are pressed</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_g.html#header-processpausekeys">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/processgameplay.html">ProcessGameplay</a> calls <a href="#processpausekeys">ProcessPauseKeys</a></span>
</div>
</div></div>
<span class="label">.ProcessPauseKeys</span><a id="processpausekeys" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">keyLogger</a><span class="operator">+</span><span class="decimal">3</span>        <span class="comment">\ Set A to the key logger entry for "7", "8", COPY and</span>
                        <span class="comment">\ DELETE (volume down, volume up, pause, unpause)</span>

 <span class="mne">BMI</span> <a class="popup destination">paws2</a>              <span class="comment">\ If there is no key press in the key logger entry, jump</span>
                        <span class="comment">\ to paws2 to return from the subroutine</span>

 <span class="mne">CMP</span> <span class="hash">#</span><span class="decimal">2</span>                 <span class="comment">\ If A &lt;> 2 then COPY is not being pressed, so jump to</span>
 <span class="mne">BNE</span> <a class="popup destination">paws2</a>              <span class="comment">\ paws2 to check for DELETE</span>

                        <span class="comment">\ If we get here then COPY is being pressed, so we need</span>
                        <span class="comment">\ to pause the game</span>

 <span class="mne">ROR</span> <a class="popup variable">gamePaused</a>         <span class="comment">\ Set bit 7 of gamePaused to indicate that the game is</span>
                        <span class="comment">\ paused (this works because the CMP above returned an</span>
                        <span class="comment">\ equality, so the C flag is set and ready to be rotated</span>
                        <span class="comment">\ into bit 7 of gamePaused)</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">8</span>                 <span class="comment">\ Update the scanner so it's filled with green, to show</span>
 <span class="mne">JSR</span> <a class="popup destination">UpdateScannerNow</a>   <span class="comment">\ that the game is paused (calling UpdateScannerNow</span>
                        <span class="comment">\ ensures the scanner is updated irrespective of whether</span>
                        <span class="comment">\ the scanner is currently enabled in-game)</span>

 <span class="mne">JSR</span> <a class="popup destination">FlushSoundBuffers</a>  <span class="comment">\ Flush all four sound channel buffers</span>

<span class="label">.paws1</span><a id="paws1" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">keyLogger</a><span class="operator">+</span><span class="decimal">3</span>        <span class="comment">\ Set A to the key logger entry for "7", "8", COPY and</span>
                        <span class="comment">\ DELETE (volume down, volume up, pause, unpause)</span>

 <span class="mne">CMP</span> <span class="hash">#</span><span class="decimal">3</span>                 <span class="comment">\ If A &lt;> 3 then DELETE is not being pressed, so jump</span>
 <span class="mne">BNE</span> <a class="popup destination">paws1</a>              <span class="comment">\ paws1 to check for key presses (or wait until no key</span>
                        <span class="comment">\ is being pressed)</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Update the scanner so it's filled with black, so the</span>
 <span class="mne">JSR</span> <a class="popup destination">UpdateScannerNow</a>   <span class="comment">\ game can resume with a blank scanner (calling</span>
                        <span class="comment">\ UpdateScannerNow ensures the scanner is updated</span>
                        <span class="comment">\ irrespective of whether the scanner is currently</span>
                        <span class="comment">\ enabled in-game)</span>

 <span class="mne">LSR</span> <a class="popup variable">gamePaused</a>         <span class="comment">\ Clear bit 7 of gamePaused to indicate that the game is</span>
                        <span class="comment">\ unpaused</span>

<span class="label">.paws2</span><a id="paws2" class="anchor"></a>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-flushsoundbuffers"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/flushsoundbuffers.html">FlushSoundBuffers</a> (category: Sound)</div><div class="summary">Flush all four sound channel buffers</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updatescannernow"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/updatescannernow.html">UpdateScannerNow</a> (category: Scanner/energy row)</div><div class="summary">Update the scanner to a new state</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-gamepaused"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#gamepaused">gamePaused</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to record whether the game is paused</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-keylogger"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#keylogger">keyLogger</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The four-byte key logger for logging game key presses</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-paws1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processpausekeys.html#paws1">paws1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-paws2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processpausekeys.html#paws2">paws2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/envelopevolumes.html">envelopeVolumes</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/processmusic.html">ProcessMusic</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
