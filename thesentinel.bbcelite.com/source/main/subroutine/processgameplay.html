<?php
include_once("../../../templates/template_functions.php");
page_header("gameplay", "subroutine_processgameplay.html", "The ProcessGameplay subroutine", "Gameplay: ProcessGameplay", "Annotated code for the ProcessGameplay subroutine in The Sentinel", "the_sentinel-code", "source_gameplay", "subroutine_processgameplay", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/getnextseed0to30.html">GetNextSeed0To30</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/updateenemytimers.html">UpdateEnemyTimers</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">ProcessGameplay</span>                                         <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Gameplay</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">A gameplay loop that processes all game key presses, returning to</span>
             <span class="headerEntry">the main game loop when the player moves, quits, loses or pans</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_b.html#header-processgameplay">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/maingameloop.html">MainGameLoop</a> calls <a href="#processgameplay">ProcessGameplay</a></span>
</div>
<hr class="light">
<span class="subheader"> Returns:</span>

   <span class="argumentLabel">C flag</span>               <span class="argumentEntry">Status flag on exit:</span>

                        <span class="argumentEntry">  * Clear if we have just finished processing a pan of</span>
                        <span class="argumentEntry">    the landscape view, and the player is still holding</span>
                        <span class="argumentEntry">    down a pan key</span>

                        <span class="argumentEntry">  * Set if any of the following are true:</span>

                        <span class="argumentEntry">    * The Sentinel has won</span>

                        <span class="argumentEntry">    * The player has moved to a new tile</span>

                        <span class="argumentEntry">    * The player has pressed the quit game key</span>

</div></div>
<span class="label">.ProcessGameplay</span><a id="processgameplay" class="anchor"></a>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Clear bit 7 of focusOnKeyAction to tell the game to</span>
 <span class="mne">STA</span> <a class="popup variable">focusOnKeyAction</a>   <span class="comment">\ stop focusing effort on implementing any key actions</span>
                        <span class="comment">\ such as landscape pans, as we are now looking at the</span>
                        <span class="comment">\ gameplay</span>

 <span class="mne">STA</span> <a class="popup variable">uTurnStatus</a>        <span class="comment">\ Clear bits 6 and 7 of uTurnStatus to clear any record</span>
                        <span class="comment">\ of a U-turn being in progress, and to prevent the "U"</span>
                        <span class="comment">\ key from performing a U-turn, so that the "U" key has</span>
                        <span class="comment">\ to be released (if applicable) before a second U-turn</span>
                        <span class="comment">\ can be performed</span>

<span class="label">.play1</span><a id="play1" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">focusOnKeyAction</a>   <span class="comment">\ If bit 7 of focusOnKeyAction is set then the game is</span>
 <span class="mne">BMI</span> <a class="popup destination">play5</a>              <span class="comment">\ focusing effort on a key action such as a landscape</span>
                        <span class="comment">\ pan, so jump to play5 to go straight to processing any</span>
                        <span class="comment">\ action key presses, skipping all the key press logic</span>
                        <span class="comment">\ below</span>

                        <span class="comment">\ We now check whether we have just finished processing</span>
                        <span class="comment">\ a landscape pan, and if so whether the player is still</span>
                        <span class="comment">\ holding down the same pan key</span>

 <span class="mne">LSR</span> <a class="popup variable">samePanKeyPress</a>    <span class="comment">\ Clear bit 7 of samePanKeyPress to record that the same</span>
                        <span class="comment">\ pan key is not being held down, which we will change</span>
                        <span class="comment">\ below if this is not the case</span>

 <span class="mne">LDA</span> <a class="popup variable">previousFocus</a>      <span class="comment">\ If bit 7 of previousFocus is clear then it matches</span>
 <span class="mne">BPL</span> <a class="popup destination">play2</a>              <span class="comment">\ the current value of focusOnKeyAction, so the value</span>
                        <span class="comment">\ of focusOnKeyAction has not changed since the last</span>
                        <span class="comment">\ time we were in the FocusOnKeyAction routine, and at</span>
                        <span class="comment">\ that point we were not focusing effort on implementing</span>
                        <span class="comment">\ a key action such as a landscape pan</span>
                        <span class="comment">\</span>
                        <span class="comment">\ So jump to play2 to skip the following check for pan</span>
                        <span class="comment">\ keys, as it isn't relevant</span>

                        <span class="comment">\ If we get here then bit 7 of focusOnKeyAction is</span>
                        <span class="comment">\ clear and bit 7 of previousFocus is set, so we must</span>
                        <span class="comment">\ have called the ProcessGameplay routine just after</span>
                        <span class="comment">\ implementing a key action such as a landscape pan</span>
                        <span class="comment">\</span>
                        <span class="comment">\ So let's check to see whether the same pan key is</span>
                        <span class="comment">\ still being held down from the pan we just finished</span>

 <span class="mne">JSR</span> <a class="popup destination">CheckForSamePanKey</a> <span class="comment">\ Check to see whether the same pan key is being held</span>
                        <span class="comment">\ down compared to the last time we checked</span>

 <span class="mne">BNE</span> <a class="popup destination">play2</a>              <span class="comment">\ If the same pan key is not being held down, jump to</span>
                        <span class="comment">\ play2 to skip the following</span>

 <span class="mne">SEC</span>                    <span class="comment">\ The same pan key is still being held down, so set bit</span>
 <span class="mne">ROR</span> <a class="popup variable">samePanKeyPress</a>    <span class="comment">\ 7 of samePanKeyPress to record this fact for use in</span>
                        <span class="comment">\ the CheckObjVisibility routine, so we can work out</span>
                        <span class="comment">\ whether it is safe to update objects without</span>
                        <span class="comment">\ corrupting any ongoing pans in the landscape view</span>

<span class="label">.play2</span><a id="play2" class="anchor"></a>

 <span class="mne">JSR</span> <a class="popup destination">ApplyEnemyTactics</a>  <span class="comment">\ Apply tactics to the enemy object in enemyObject</span>
                        <span class="comment">\</span>
                        <span class="comment">\ This call also moves enemyObject on to the next enemy</span>
                        <span class="comment">\ object (in the range 0 to 7), so the next time we</span>
                        <span class="comment">\ reach this point in the gameplay loop, this call will</span>
                        <span class="comment">\ apply tactics to the next enemy number</span>
                        <span class="comment">\</span>
                        <span class="comment">\ If there is no enemy object allocated to the object</span>
                        <span class="comment">\ number (which may be the case if the landscape has</span>
                        <span class="comment">\ fewer than eight enemies, or if an enemy has been</span>
                        <span class="comment">\ absorbed), then no tactics are applied and the object</span>
                        <span class="comment">\ number in enemyObject moves on by one, ready for the</span>
                        <span class="comment">\ next time we reach this point in the gameplay loop</span>
                        <span class="comment">\</span>
                        <span class="comment">\ So we process each enemy once every eight iterations</span>
                        <span class="comment">\ of the gameplay loop, irrespective of the number of</span>
                        <span class="comment">\ enemies in the landscape</span>

 <span class="mne">LDA</span> <a class="popup variable">sentinelHasWon</a>     <span class="comment">\ If bit 7 of sentinelHasWon is clear then the player</span>
 <span class="mne">BEQ</span> <a class="popup destination">play4</a>              <span class="comment">\ has not been absorbed by the Sentinel, so jump to</span>
                        <span class="comment">\ play4 to progress the game</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">30</span>                <span class="comment">\ The Sentinel has won, so display the game over screen</span>
 <span class="mne">JSR</span> <a class="popup destination">ShowGameOverScreen</a> <span class="comment">\ with A = 30, so we decay the screen to black with a</span>
                        <span class="comment">\ mass of 30 * 2400 = 72,000 randomly placed black dots</span>

<span class="label">.play3</span><a id="play3" class="anchor"></a>

 <span class="mne">JSR</span> <a class="popup destination">FocusOnKeyAction</a>   <span class="comment">\ Tell the game to start focusing effort on the key</span>
                        <span class="comment">\ action that has been initiated (be it a pan of the</span>
                        <span class="comment">\ landscape view or an action like absorb or transfer)</span>

 <span class="mne">SEC</span>                    <span class="comment">\ Set the C flag to indicate that one of the following</span>
                        <span class="comment">\ is true:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * The Sentinel has won</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * The player has moved to a new tile</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * The player has pressed the quit game key</span>
                        <span class="comment">\</span>
                        <span class="comment">\ so the main game loop can process this action</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>

<span class="label">.play4</span><a id="play4" class="anchor"></a>

 <span class="mne">ASL</span> <a class="popup variable">playerHasMovedTile</a> <span class="comment">\ Shift bit 7 of playerHasMovedTile into the C flag so</span>
                        <span class="comment">\ we can check it in the next instruction, and clear bit</span>
                        <span class="comment">\ 7 to clear the flag as we are about to process any</span>
                        <span class="comment">\ tile move that has occurred</span>

 <span class="mne">BCS</span> <a class="popup destination">play3</a>              <span class="comment">\ If the C flag is set then bit 7 of playerHasMovedTile</span>
                        <span class="comment">\ was set before we cleared it, which indicates that the</span>
                        <span class="comment">\ player has moved to a new tile, so jump to play3 to</span>
                        <span class="comment">\ return from the subroutine with the C flag set</span>

 <span class="mne">BIT</span> <a class="popup variable">quitGame</a>           <span class="comment">\ If bit 7 of quitGame is set then the player has</span>
 <span class="mne">BMI</span> <a class="popup destination">play3</a>              <span class="comment">\ pressed function key f1 to quit the game, so jump to</span>
                        <span class="comment">\ play3 to return from the subroutine with the C flag</span>
                        <span class="comment">\ set</span>

 <span class="mne">JSR</span> <a class="popup destination">GetPlayerDrain</a>     <span class="comment">\ Calculate whether the player is being scanned by an</span>
                        <span class="comment">\ enemy and whether the enemy can see the player's tile</span>

 <span class="mne">JSR</span> <a class="popup destination">ProcessPauseKeys</a>   <span class="comment">\ Pause or unpause the game when COPY or DELETE are</span>
                        <span class="comment">\ pressed</span>

 <span class="mne">JSR</span> <a class="popup destination">ProcessSound</a>       <span class="comment">\ Process any sounds or music that are being made in the</span>
                        <span class="comment">\ background</span>

 <span class="mne">JSR</span> <a class="popup destination">ProcessVolumeKeys</a>  <span class="comment">\ Adjust the volume of the sound envelopes when the</span>
                        <span class="comment">\ volume keys are pressed</span>

 <span class="mne">JMP</span> <a class="popup destination">play1</a>              <span class="comment">\ Jump back to play1 to repeat the main game loop</span>

<span class="label">.play5</span><a id="play5" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">panKeyBeingPressed</a> <span class="comment">\ If no pan key is currently being pressed, jump to</span>
 <span class="mne">BMI</span> <a class="popup destination">play6</a>              <span class="comment">\ play6 to process any action key presses</span>

 <span class="mne">CLC</span>                    <span class="comment">\ Clear the C flag to indicate that we just finished a</span>
                        <span class="comment">\ landscape pan and the player is still holding down a</span>
                        <span class="comment">\ pan key, so the main game loop can process a new pan</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>

<span class="label">.play6</span><a id="play6" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">keyLogger</a><span class="operator">+</span><span class="decimal">1</span>        <span class="comment">\ Set A to the key logger entry for "A", "Q", "R", "T",</span>
                        <span class="comment">\ "B", "H", or "U" (absorb, transfer, create robot,</span>
                        <span class="comment">\ create tree, create boulder, hyperspace, U-turn)</span>

 <span class="mne">BMI</span> <a class="popup destination">play9</a>              <span class="comment">\ If there is no key press in the key logger entry, jump</span>
                        <span class="comment">\ back to the start of the routine via play9 to keep</span>
                        <span class="comment">\ checking for key presses</span>

                        <span class="comment">\ If we get here then the player is pressing "A", "Q",</span>
                        <span class="comment">\ "R", "T", "B", "H" or "U" (absorb, transfer, create</span>
                        <span class="comment">\ robot, create tree, create boulder, hyperspace,</span>
                        <span class="comment">\ U-turn), so the possible values for A are:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * 0  for key press "R" (Create robot)</span>
                        <span class="comment">\   * 2  for key press "T" (Create tree)</span>
                        <span class="comment">\   * 3  for key press "B" (Create boulder)</span>
                        <span class="comment">\   * 32 for key press "A" (Absorb)</span>
                        <span class="comment">\   * 33 for key press "Q" (Transfer)</span>
                        <span class="comment">\   * 34 for key press "H" (Hyperspace)</span>
                        <span class="comment">\   * 35 for key press "U" (U-turn)</span>

 <span class="mne">CMP</span> <span class="hash">#</span><span class="decimal">34</span>                <span class="comment">\ If A >= 34 then "H" (hyperspace) or "U" (U-turn) is</span>
 <span class="mne">BCS</span> <a class="popup destination">play7</a>              <span class="comment">\ being pressed, so jump to play7 to skip the following</span>
                        <span class="comment">\ check, as we can hyperspace and U-turn at any point,</span>
                        <span class="comment">\ irrespective of whether the sights are being shown</span>

 <span class="mne">BIT</span> <a class="popup variable">sightsAreVisible</a>   <span class="comment">\ If bit 7 of sightsAreVisible is clear then the sights</span>
 <span class="mne">BPL</span> <a class="popup destination">play9</a>              <span class="comment">\ are not being shown, so jump back to the start of the</span>
                        <span class="comment">\ routine via play9 to keep checking for key presses, as</span>
                        <span class="comment">\ we can only create, absorb and transfer when the</span>
                        <span class="comment">\ sights are visible</span>

                        <span class="comment">\ If we get here then the sights are being shown, so we</span>
                        <span class="comment">\ can process the key press</span>

<span class="label">.play7</span><a id="play7" class="anchor"></a>

 <span class="mne">STA</span> <a class="popup variable">keyPress</a>           <span class="comment">\ Record the value from the key logger in keyPress, so</span>
                        <span class="comment">\ we can refer to it in the call to ProcessActionKeys</span>

 <span class="mne">LSR</span> <a class="popup variable">activateSentinel</a>   <span class="comment">\ The player has pressed a key that expends or absorbs</span>
                        <span class="comment">\ energy, which activates the Sentinel at the very start</span>
                        <span class="comment">\ of each level (the Sentinel and Sentries are inactive</span>
                        <span class="comment">\ until this point, giving the player time to get their</span>
                        <span class="comment">\ bearings when they first start a landscape)</span>
                        <span class="comment">\</span>
                        <span class="comment">\ So clear bit 7 of activateSentinel to indicate that</span>
                        <span class="comment">\ the Sentinel is activated and the game has started</span>

 <span class="mne">JSR</span> <a class="popup destination">ProcessActionKeys</a>  <span class="comment">\ Process any key presses in key logger entry 1, which</span>
                        <span class="comment">\ is where action key presses are stored (absorb,</span>
                        <span class="comment">\ transfer, create, hyperspace, U-turn)</span>

 <span class="mne">BCS</span> <a class="popup destination">play8</a>              <span class="comment">\ If the call to ProcessActionKeys returned with the C</span>
                        <span class="comment">\ flag set, then it didn't add or remove any objects, so</span>
                        <span class="comment">\ jump to play8 to skip the following</span>

                        <span class="comment">\ If we get here then the call to ProcessActionKeys</span>
                        <span class="comment">\ added or removed an object, so we now need to make the</span>
                        <span class="comment">\ appropriate sound and draw the updated object</span>
                        <span class="comment">\ on-screen</span>

 <span class="mne">JSR</span> <a class="popup destination">FlushSoundBuffer0</a>  <span class="comment">\ Flush the sound channel 0 buffer</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">2</span>                 <span class="comment">\ Make sound #2 (create/absorb object white noise)</span>
 <span class="mne">JSR</span> <a class="popup destination">MakeSound</a>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="binary">%11000000</span>         <span class="comment">\ Set bits 6 and 7 of ditherObjectSights so we dither</span>
 <span class="mne">STA</span> <a class="popup variable">ditherObjectSights</a> <span class="comment">\ the updated object onto the screen (bit 6) and remove</span>
                        <span class="comment">\ the sights before updating (bit 7) in the call to the</span>
                        <span class="comment">\ DrawUpdatedObject routine</span>

 <span class="mne">LSR</span> <a class="popup variable">doNotDitherObject</a>  <span class="comment">\ Clear bit 7 of doNotDitherObject to enable objects to</span>
                        <span class="comment">\ be updated on the screen with a dithered effect</span>

 <span class="mne">JSR</span> <a class="popup destination">DrawUpdatedObject</a>  <span class="comment">\ Draw the updated object (or the landscape where the</span>
                        <span class="comment">\ object used to be) into the screen buffer and dither</span>
                        <span class="comment">\ it onto the screen, pixel by pixel and randomly</span>

 <span class="mne">JSR</span> <a class="popup destination">FlushSoundBuffer0</a>  <span class="comment">\ Flush the sound channel 0 buffer</span>

 <span class="mne">JSR</span> <a class="popup destination">UpdateIconsScanner</a> <span class="comment">\ Update the icons in the top-left corner of the screen</span>
                        <span class="comment">\ to show the player's current energy level and redraw</span>
                        <span class="comment">\ the scanner box</span>

<span class="label">.play8</span><a id="play8" class="anchor"></a>

 <span class="mne">ASL</span> <a class="popup variable">playerHasMovedTile</a> <span class="comment">\ Shift bit 7 of playerHasMovedTile into the C flag so</span>
                        <span class="comment">\ we can check it in the next instruction, and clear bit</span>
                        <span class="comment">\ 7 to clear the flag as we are about to process any</span>
                        <span class="comment">\ tile move that has occurred</span>

 <span class="mne">BCC</span> <a class="popup destination">play9</a>              <span class="comment">\ If bit 7 of playerHasMovedTile was clear before we</span>
                        <span class="comment">\ cleared it, then the player has not moved to a new</span>
                        <span class="comment">\ tile, so jump back to the start of the routine via</span>
                        <span class="comment">\ play9 to continue processing the gameplay</span>

                        <span class="comment">\ If we get here then bit 7 of playerHasMovedTile was</span>
                        <span class="comment">\ set before we cleared it, which indicates that the</span>
                        <span class="comment">\ player has moved to a new tile, so return from the</span>
                        <span class="comment">\ subroutine with the C flag set</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>

<span class="label">.play9</span><a id="play9" class="anchor"></a>

 <span class="mne">JMP</span> <a class="popup destination">ProcessGameplay</a>    <span class="comment">\ Jump back to the start of the ProcessGameplay routine</span>
                        <span class="comment">\ to keep processing the gameplay</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-applyenemytactics"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/applyenemytactics.html">ApplyEnemyTactics</a> (category: Gameplay)</div><div class="summary">Apply tactics to an enemy object, setting things up so the next call applies tactics to the next enemy object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-checkforsamepankey"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/checkforsamepankey.html">CheckForSamePanKey</a> (category: Keyboard)</div><div class="summary">Check to see whether the same pan key is being held down compared to the last time we checked</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawupdatedobject"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/drawupdatedobject.html">DrawUpdatedObject</a> (category: Drawing objects)</div><div class="summary">Draw an updated object on-screen, optionally with a dithered effect, and with or without the surrounding landscape</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-flushsoundbuffer0"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/flushsoundbuffer0.html">FlushSoundBuffer0</a> (category: Sound)</div><div class="summary">Flush the sound channel 0 buffer</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-focusonkeyaction"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/focusonkeyaction.html">FocusOnKeyAction</a> (category: Keyboard)</div><div class="summary">Tell the game to start focusing effort on the action that has been initiated, such as a pan of the landscape, absorb, transfer etc.</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-getplayerdrain"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/getplayerdrain.html">GetPlayerDrain</a> (category: Gameplay)</div><div class="summary">Calculate whether the player is being scanned by an enemy and whether the enemy can see the player's tile</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-makesound"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/makesound.html">MakeSound</a> (category: Sound)</div><div class="summary">Make a sound</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-processactionkeys"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/processactionkeys_part_1_of_2.html">ProcessActionKeys (Part 1 of 2)</a> (category: Keyboard)</div><div class="summary">Process an action key press from key logger entry 1 (absorb, transfer, create, hyperspace, U-turn)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-processgameplay"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/processgameplay.html">ProcessGameplay</a> (category: Gameplay)</div><div class="summary">A gameplay loop that processes all game key presses, returning to the main game loop when the player moves, quits, loses or pans</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-processpausekeys"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/processpausekeys.html">ProcessPauseKeys</a> (category: Keyboard)</div><div class="summary">Pause or unpause the game when COPY or DELETE are pressed</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-processsound"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/processsound.html">ProcessSound</a> (category: Sound)</div><div class="summary">Process any sound effects that have been configured so they play in the background (this is called regularly throughout gameplay)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-processvolumekeys"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/processvolumekeys.html">ProcessVolumeKeys</a> (category: Sound)</div><div class="summary">Adjust the volume of the sound envelopes when the volume keys are pressed</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-showgameoverscreen"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/showgameoverscreen.html">ShowGameOverScreen</a> (category: Title screen)</div><div class="summary">Display the game over screen</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updateiconsscanner"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/updateiconsscanner.html">UpdateIconsScanner</a> (category: Scanner/energy row)</div><div class="summary">Update the icons in the top-left corner of the screen to show the player's current energy level and redraw the scanner box</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-activatesentinel"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#activatesentinel">activateSentinel</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to record when the Sentinel is activated at the start of the game (by the player pressing a key that expends or absorbs energy</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ditherobjectsights"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#ditherobjectsights">ditherObjectSights</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Configures how an updated object is drawn onto the screen in the DrawUpdatedObject routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-donotditherobject"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#donotditherobject">doNotDitherObject</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Controls whether the DitherScreenBuffer routine can update an object on the screen using a dithered effect</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-focusonkeyaction"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#focusonkeyaction">focusOnKeyAction</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag that determines whether the game should focus effort on implementing a key action, such as a pan of the landscape view</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-keylogger"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#keylogger">keyLogger</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The four-byte key logger for logging game key presses</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-keypress"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#keypress">keyPress</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The key logger value for a key press</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-pankeybeingpressed"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#pankeybeingpressed">panKeyBeingPressed</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The direction in which the player is currently panning</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play1">play1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play2">play2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play3"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play3">play3</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play4"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play4">play4</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play5"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play5">play5</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play6"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play6">play6</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play7"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play7">play7</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play8"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play8">play8</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-play9"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/processgameplay.html#play9">play9</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-playerhasmovedtile"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#playerhasmovedtile">playerHasMovedTile</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to record whether the player has moved to a new tile by transferring or hyperspacing, so we can decide whether to regenerate the player's landscape view</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-previousfocus"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#previousfocus">previousFocus</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The previous setting of focusOnKeyAction, so we can detect (in the ProcessGameplay routine) whether the player is still holding down a pan key after we finish scrolling the screen for the previous pan</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-quitgame"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#quitgame">quitGame</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to record whether the player has pressed function key f1 to quit the game</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-samepankeypress"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#samepankeypress">samePanKeyPress</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Records whether the same pan key is being held down after we have just finished panning the landscape view</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-sentinelhaswon"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#sentinelhaswon">sentinelHasWon</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to record when the player runs out of energy (i.e. the energy level goes negative), at which point the Sentinel wins</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-sightsarevisible"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#sightsarevisible">sightsAreVisible</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Controls whether the sights are being shown</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-uturnstatus"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#uturnstatus">uTurnStatus</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to record whether we are performing or have just performed a U-turn</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/getnextseed0to30.html">GetNextSeed0To30</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/updateenemytimers.html">UpdateEnemyTimers</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
