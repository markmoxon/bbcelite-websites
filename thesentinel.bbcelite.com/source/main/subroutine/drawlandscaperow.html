<?php
include_once("../../../templates/template_functions.php");
page_header("drawing_the_landscape", "subroutine_drawlandscaperow.html", "The DrawLandscapeRow subroutine", "Drawing the landscape: DrawLandscapeRow", "Annotated code for the DrawLandscapeRow subroutine in The Sentinel", "the_sentinel-code", "source_drawing_the_landscape", "subroutine_drawlandscaperow", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/gettileviewangles_part_4_of_4.html">GetTileViewAngles (Part 4 of 4)</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/flipbuffertype.html">FlipBufferType</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">DrawLandscapeRow</span>                                        <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Drawing the landscape</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Draw a row of tiles between the left visible edge and the right</span>
             <span class="headerEntry">visible, in two parts towards each side of the viewer</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_e.html#header-drawlandscaperow">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/drawlandscapeview_part_2_of_3.html">DrawLandscapeView (Part 2 of 3)</a> calls <a href="#drawlandscaperow">DrawLandscapeRow</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/drawlandscapeview_part_3_of_3.html">DrawLandscapeView (Part 3 of 3)</a> calls <a href="#drawlandscaperow">DrawLandscapeRow</a></span>
</div>
</div></div>
<span class="label">.DrawLandscapeRow</span><a id="drawlandscaperow" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">xTileViewLeftEdge</a>  <span class="comment">\ Set xTileToDraw to the column number of the tile at</span>
 <span class="mne">STA</span> <a class="popup variable">xTileToDraw</a>        <span class="comment">\ the left edge of the visible row we want to draw</span>

<span class="label">.draw1</span><a id="draw1" class="anchor"></a>

 <span class="mne">CMP</span> <a class="popup variable">xTileViewRightEdge</a> <span class="comment">\ If we have gone past the right edge, jump to draw4 to</span>
 <span class="mne">BCS</span> <a class="popup destination">draw4</a>              <span class="comment">\ return from the subroutine</span>

 <span class="mne">CMP</span> <a class="popup variable">xTileViewer</a>        <span class="comment">\ If we have gone past the viewer's tile column, jump to</span>
 <span class="mne">BCS</span> <a class="popup destination">draw2</a>              <span class="comment">\ draw2 to draw the second half</span>

 <span class="mne">JSR</span> <a class="popup destination">DrawTileAndObjects</a> <span class="comment">\ Draw the tile and any objects stacked on it</span>

 <span class="mne">INC</span> <a class="popup variable">xTileToDraw</a>        <span class="comment">\ Increment the column number to move right along the</span>
                        <span class="comment">\ row</span>

 <span class="mne">LDA</span> <a class="popup variable">xTileToDraw</a>        <span class="comment">\ Set A to the updated column number of the tile we want</span>
                        <span class="comment">\ to draw</span>

 <span class="mne">JMP</span> <a class="popup destination">draw1</a>              <span class="comment">\ Loop back to draw1 the next tile to the right until we</span>
                        <span class="comment">\ reach the viewer's tile column or reach the end of the</span>
                        <span class="comment">\ row</span>

<span class="label">.draw2</span><a id="draw2" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">xTileViewRightEdge</a> <span class="comment">\ Set A to the column number of the tile at the right</span>
                        <span class="comment">\ edge of the visible row we want to draw</span>

<span class="label">.draw3</span><a id="draw3" class="anchor"></a>

 <span class="mne">SEC</span>                    <span class="comment">\ Decrement the column counter in A to move left along</span>
 <span class="mne">SBC</span> <span class="hash">#</span><span class="decimal">1</span>                 <span class="comment">\ the row</span>

 <span class="mne">BMI</span> <a class="popup destination">draw4</a>              <span class="comment">\ If we have reached the start of the row, jump to draw4</span>
                        <span class="comment">\ to return from the subroutine</span>

 <span class="mne">STA</span> <a class="popup variable">xTileToDraw</a>        <span class="comment">\ Store the updated column number of the tile we want to</span>
                        <span class="comment">\ draw</span>

 <span class="mne">CMP</span> <a class="popup variable">xTileViewLeftEdge</a>  <span class="comment">\ If we have gone past the left edge, jump to draw4 to</span>
 <span class="mne">BCC</span> <a class="popup destination">draw4</a>              <span class="comment">\ return from the subroutine</span>

 <span class="mne">CMP</span> <a class="popup variable">xTileViewer</a>        <span class="comment">\ If we have gone past the viewer's tile column, jump to</span>
 <span class="mne">BCC</span> <a class="popup destination">draw4</a>              <span class="comment">\ draw4 to return from the subroutine</span>

 <span class="mne">JSR</span> <a class="popup destination">DrawTileAndObjects</a> <span class="comment">\ Draw the tile and any objects stacked on it</span>

 <span class="mne">LDA</span> <a class="popup variable">xTileToDraw</a>        <span class="comment">\ Set A to the column number of the tile we just drew</span>

 <span class="mne">JMP</span> <a class="popup destination">draw3</a>              <span class="comment">\ Loop back to draw1 the next tile to the left until we</span>
                        <span class="comment">\ reach the viewer's tile column or reach the end of the</span>
                        <span class="comment">\ row</span>

<span class="label">.draw4</span><a id="draw4" class="anchor"></a>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawtileandobjects"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/drawtileandobjects.html">DrawTileAndObjects</a> (category: Drawing the landscape)</div><div class="summary">Draw a tile and any objects stacked on it</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-draw1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawlandscaperow.html#draw1">draw1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-draw2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawlandscaperow.html#draw2">draw2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-draw3"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawlandscaperow.html#draw3">draw3</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-draw4"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawlandscaperow.html#draw4">draw4</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xtiletodraw"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xtiletodraw">xTileToDraw</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The column number of the tile we are currently drawing</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xtileviewleftedge"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xtileviewleftedge">xTileViewLeftEdge</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The tile number at the left edge of the visible portion of the row we are currently processing when drawing the landscape</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xtileviewrightedge"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xtileviewrightedge">xTileViewRightEdge</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The tile number at the right edge of the visible portion of the row we are currently processing when drawing the landscape</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xtileviewer"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xtileviewer">xTileViewer</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The tile x-coordinate of the viewer, but with the axes rotated to match the orientation of the viewer, so we can draw the landscape along the line of sight, towards the viewer's tile</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/gettileviewangles_part_4_of_4.html">GetTileViewAngles (Part 4 of 4)</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/flipbuffertype.html">FlipBufferType</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
