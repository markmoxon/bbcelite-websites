<?php
include_once("../../../templates/template_functions.php");
page_header("maths_geometry", "subroutine_gethypotenuseangle.html", "The GetHypotenuseAngle subroutine", "Maths (Geometry): GetHypotenuseAngle", "Annotated code for the GetHypotenuseAngle subroutine in The Sentinel", "the_sentinel-code", "source_maths_geometry", "subroutine_gethypotenuseangle", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/drawviewyawhi.html">drawViewYawHi</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/getpitchangledelta.html">GetPitchAngleDelta</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">GetHypotenuseAngle</span>                                      <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Maths (Geometry)</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Calculate the angle of the hypotenuse in a right-angle triangle</span>
             <span class="headerEntry">given the two non-hypotenuse sides (i.e. two orthogonal axes)</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_i.html#header-gethypotenuseangle">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/getobjectangles.html">GetObjectAngles</a> calls <a href="#gethypotenuseangle">GetHypotenuseAngle</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/getobjpointangles.html">GetObjPointAngles</a> calls <a href="#gethypotenuseangle">GetHypotenuseAngle</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/getpitchangledelta.html">GetPitchAngleDelta</a> calls <a href="#gethypotenuseangle">GetHypotenuseAngle</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/gettileviewangles_part_1_of_4.html">GetTileViewAngles (Part 1 of 4)</a> calls <a href="#gethypotenuseangle">GetHypotenuseAngle</a></span>
</div>
<hr class="light">
 Calculate the tangent of the angle in a right-angle triangle, i.e. the angle
 of the hypotenuse, given the two non-hypotenuse sides (typically orthogonal
 coordinate axes).

 The arguments are as follows:

   * Absolute x-axis length in (xDeltaAbsoluteHi xDeltaLo)

   * Sign of the x-axis length in xDeltaHi

   * Absolute z-axis length in (zDeltaAbsoluteHi zDeltaLo)

   * Sign of the z-axis length in zDeltaHi

<hr class="light">
<span class="subheader"> Arguments:</span>

   <span class="argumentLabel">xDeltaAbsoluteHi</span>     <span class="argumentEntry">High byte of the absolute x-axis length</span>

   <span class="argumentLabel">xDelta(Hi Lo)</span>        <span class="argumentEntry">The signed x-axis length</span>

   <span class="argumentLabel">zDeltaAbsoluteHi</span>     <span class="argumentEntry">High byte of the absolute z-axis length</span>

   <span class="argumentLabel">zDelta(Hi Lo)</span>        <span class="argumentEntry">The signed z-axis length</span>

<hr class="light">
<span class="subheader"> Returns:</span>

   <span class="argumentLabel">angleTangent</span>         <span class="argumentEntry">The tangent of the angle of the hypotenuse</span>

   <span class="argumentLabel">angle(Hi Lo)</span>         <span class="argumentEntry">The angle of the hypotenuse</span>

   <span class="argumentLabel">a(Hi Lo)</span>             <span class="argumentEntry">The length of the longer side in the triangle</span>

   <span class="argumentLabel">b(Hi Lo)</span>             <span class="argumentEntry">The length of the shorter side in the triangle</span>

</div></div>
<span class="label">.ghyp1</span><a id="ghyp1" class="anchor"></a>

                        <span class="comment">\ If we get here then A = 0</span>

 <span class="mne">STA</span> <a class="popup variable">angleTangent</a>       <span class="comment">\ Set angleTangent = 0</span>

 <span class="mne">STA</span> <a class="popup variable">angleLo</a>            <span class="comment">\ Set angle(Hi Lo) = 0</span>
 <span class="mne">STA</span> <a class="popup variable">angleHi</a>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>

<span class="label">.GetHypotenuseAngle</span><a id="gethypotenuseangle" class="anchor"></a>

                        <span class="comment">\ We are going to be calculating the angle in a</span>
                        <span class="comment">\ right-angled triangle with the following opposite and</span>
                        <span class="comment">\ adjacent sides:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   (zDeltaAbsoluteHi zDeltaLo)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   (xDeltaAbsoluteHi xDeltaLo)</span>
                        <span class="comment">\</span>
                        <span class="comment">\ We start by working out which is the longer of the two</span>
                        <span class="comment">\ non-hypotenuse sides</span>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaAbsoluteHi</a>   <span class="comment">\ If zDeltaAbsoluteHi &lt; xDeltaAbsoluteHi, jump to ghyp2</span>
 <span class="mne">CMP</span> <a class="popup variable">xDeltaAbsoluteHi</a>
 <span class="mne">BCC</span> <a class="popup destination">ghyp2</a>

 <span class="mne">BNE</span> <a class="popup destination">ghyp3</a>              <span class="comment">\ If zDeltaAbsoluteHi > xDeltaAbsoluteHi, jump to ghyp3</span>

                        <span class="comment">\ If we get here then the high bytes in zDeltaAbsoluteHi</span>
                        <span class="comment">\ and xDeltaAbsoluteHi are the same, so now we compare</span>
                        <span class="comment">\ the low bytes</span>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ If zDeltaLo >= xDeltaLo, jump to ghyp3</span>
 <span class="mne">CMP</span> <a class="popup variable">xDeltaLo</a>
 <span class="mne">BCS</span> <a class="popup destination">ghyp3</a>

<span class="label">.ghyp2</span><a id="ghyp2" class="anchor"></a>

                        <span class="comment">\ If we get here then:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   (zDeltaAbsoluteHi zDeltaLo) &lt;</span>
                        <span class="comment">\                            (xDeltaAbsoluteHi xDeltaLo)</span>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaAbsoluteHi</a>   <span class="comment">\ Set b(Hi Lo) = (zDeltaAbsoluteHi zDeltaLo)</span>
 <span class="mne">STA</span> <a class="popup variable">bHi</a>                <span class="comment">\</span>
 <span class="mne">LDA</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ So b(Hi Lo) is the shorter side</span>
 <span class="mne">STA</span> <a class="popup variable">bLo</a>

 <span class="mne">LDA</span> <a class="popup variable">xDeltaLo</a>           <span class="comment">\ Set a(Hi Lo) = (xDeltaAbsoluteHi xDeltaLo)</span>
 <span class="mne">STA</span> <a class="popup variable">aLo</a>                <span class="comment">\</span>
 <span class="mne">LDA</span> <a class="popup variable">xDeltaAbsoluteHi</a>   <span class="comment">\ So a(Hi Lo) is the longer side</span>
 <span class="mne">STA</span> <a class="popup variable">aHi</a>

 <span class="mne">JMP</span> <a class="popup destination">ghyp5</a>              <span class="comment">\ Jump to ghyp5 to keep going</span>

<span class="label">.ghyp3</span><a id="ghyp3" class="anchor"></a>

                        <span class="comment">\ If we get here then:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   (zDeltaAbsoluteHi zDeltaLo) >=</span>
                        <span class="comment">\                            (xDeltaAbsoluteHi xDeltaLo)</span>

 <span class="mne">LDA</span> <a class="popup variable">xDeltaAbsoluteHi</a>   <span class="comment">\ Set b(Hi Lo) = (xDeltaAbsoluteHi xDeltaLo)</span>
 <span class="mne">STA</span> <a class="popup variable">bHi</a>                <span class="comment">\</span>
 <span class="mne">LDA</span> <a class="popup variable">xDeltaLo</a>           <span class="comment">\ So b(Hi Lo) is the shorter side</span>
 <span class="mne">STA</span> <a class="popup variable">bLo</a>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ Set a(Hi Lo) = (zDeltaAbsoluteHi zDeltaLo)</span>
 <span class="mne">STA</span> <a class="popup variable">aLo</a>                <span class="comment">\</span>
 <span class="mne">LDA</span> <a class="popup variable">zDeltaAbsoluteHi</a>   <span class="comment">\ So a(Hi Lo) is the longer side</span>
 <span class="mne">STA</span> <a class="popup variable">aHi</a>

 <span class="mne">ORA</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ If both zDeltaAbsoluteHi and zDeltaLo are zero then</span>
 <span class="mne">BEQ</span> <a class="popup destination">ghyp1</a>              <span class="comment">\ a(Hi Lo) = 0, so jump to ghyp1 to return from the</span>
                        <span class="comment">\ subroutine with the following:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * angleTangent = 0</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * angle(Hi Lo) = 0</span>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaAbsoluteHi</a>   <span class="comment">\ Set A to zDeltaAbsoluteHi once again</span>

 <span class="mne">JMP</span> <a class="popup destination">ghyp9</a>              <span class="comment">\ Jump to ghyp9 to keep going</span>

<span class="label">.ghyp4</span><a id="ghyp4" class="anchor"></a>

 <span class="mne">ASL</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ Shift (zDeltaAbsoluteHi zDeltaLo) left by one place to</span>
 <span class="mne">ROL</span> <a class="popup variable">zDeltaAbsoluteHi</a>   <span class="comment">\ scale it up</span>

<span class="label">.ghyp5</span><a id="ghyp5" class="anchor"></a>

                        <span class="comment">\ If we jump here then:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * (zDeltaAbsoluteHi zDeltaLo) &lt;</span>
                        <span class="comment">\                            (xDeltaAbsoluteHi xDeltaLo)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * a(Hi Lo) is the longer side</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * b(Hi Lo) is the shorter side</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * A = xDeltaAbsoluteHi</span>
                        <span class="comment">\</span>
                        <span class="comment">\ The last one means that the length of the x-axis side</span>
                        <span class="comment">\ is currently in (A xDeltaLo)</span>

                        <span class="comment">\ We start by shifting the lengths of both sides to the</span>
                        <span class="comment">\ left until bit 7 of A is set</span>
                        <span class="comment">\</span>
                        <span class="comment">\ As we know that (A xDeltaLo) is the longest side, this</span>
                        <span class="comment">\ scales both lengths up by the same amount until they</span>
                        <span class="comment">\ are as large as they can be while still fitting into a</span>
                        <span class="comment">\ 16-bit number</span>

 <span class="mne">ASL</span> <a class="popup variable">xDeltaLo</a>           <span class="comment">\ Shift (A xDeltaLo) left by one place to scale it up</span>
 <span class="mne">ROL</span> <span class="register">A</span>

 <span class="mne">BCC</span> <a class="popup destination">ghyp4</a>              <span class="comment">\ If we just shifted a zero out of bit 7 of (A xDeltaLo)</span>
                        <span class="comment">\ then jump back to ghyp4 to scale the x-axis length and</span>
                        <span class="comment">\ keep scaling until we shift a 1 out of bit 7, at which</span>
                        <span class="comment">\ point we will have scaled (A xDeltaLo) as far as we</span>
                        <span class="comment">\ can</span>

 <span class="mne">ROR</span> <span class="register">A</span>                  <span class="comment">\ Shift the 1 back into bit 7 of (A xDeltaLo) to undo</span>
 <span class="mne">ROR</span> <a class="popup variable">xDeltaLo</a>           <span class="comment">\ the last left-shift, so (A xDeltaLo) is now as large</span>
                        <span class="comment">\ as it can be</span>

 <span class="mne">STA</span> <a class="popup variable">V</a>                  <span class="comment">\ Set V to the high byte of the scaled x-axis length</span>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ Set T to the low byte of the scaled z-axis length</span>
 <span class="mne">STA</span> <a class="popup variable">T</a>

 <span class="mne">LDA</span> <a class="popup variable">xDeltaLo</a>           <span class="comment">\ Set W to the low byte of the scaled x-axis length,</span>
 <span class="mne">AND</span> <span class="hash">#</span><span class="binary">%11111100</span>         <span class="comment">\ with bits 0 and 1 cleared</span>
 <span class="mne">STA</span> <a class="popup variable">W</a>                  <span class="comment">\</span>
                        <span class="comment">\ Bits 0 and 1 of xDeltaLo will only be non-zero if the</span>
                        <span class="comment">\ x-axis length has not been scaled up or has only been</span>
                        <span class="comment">\ scaled up by one place, as scaling it up by two places</span>
                        <span class="comment">\ will clear these bits anyway</span>
                        <span class="comment">\</span>
                        <span class="comment">\ Is this a requirement for W so it can be passed to</span>
                        <span class="comment">\ GetAngleFromCoords ???</span>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaAbsoluteHi</a>   <span class="comment">\ Set A to the high byte of the scaled z-axis length</span>

                        <span class="comment">\ So by this point we have:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * (A T) = the scaled z-axis length</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * (V W) = the scaled x-axis length</span>

 <span class="mne">JSR</span> <a class="popup destination">GetAngleFromCoords</a> <span class="comment">\ Calculate the following angle:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   angle(Hi Lo) = arctan( (A T) / (V W) )</span>
                        <span class="comment">\                = arctan( z-axis / x-axis )</span>
                        <span class="comment">\</span>
                        <span class="comment">\ This works because the x-axis length is greater than</span>
                        <span class="comment">\ the z-axis length, so the x-axis is the adjacent side</span>
                        <span class="comment">\ and the z-axis is the opposite side</span>

 <span class="mne">LDA</span> <a class="popup variable">xDeltaHi</a>           <span class="comment">\ If xDeltaHi and zDeltaHi have different sign bits in</span>
 <span class="mne">EOR</span> <a class="popup variable">zDeltaHi</a>           <span class="comment">\ bit 7, then EOR'ing them will produce a 1, so jump to</span>
 <span class="mne">BMI</span> <a class="popup destination">ghyp6</a>              <span class="comment">\ ghyp6 to skip the following, as the sign of the angle</span>
                        <span class="comment">\ is already correct ???</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Negate angle(Hi Lo) to give it the correct sign</span>
 <span class="mne">SEC</span>
 <span class="mne">SBC</span> <a class="popup variable">angleLo</a>
 <span class="mne">STA</span> <a class="popup variable">angleLo</a>
 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>
 <span class="mne">SBC</span> <a class="popup variable">angleHi</a>
 <span class="mne">STA</span> <a class="popup variable">angleHi</a>

<span class="label">.ghyp6</span><a id="ghyp6" class="anchor"></a>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="binary">%01000000</span>         <span class="comment">\ If bit 7 of xDeltaHi is clear then set A = %01000000</span>
 <span class="mne">BIT</span> <a class="popup variable">xDeltaHi</a>           <span class="comment">\ otherwise set A = %11000000</span>
 <span class="mne">BPL</span> <a class="popup destination">ghyp7</a>
 <span class="mne">LDA</span> <span class="hash">#</span><span class="binary">%11000000</span>

<span class="label">.ghyp7</span><a id="ghyp7" class="anchor"></a>

 <span class="mne">CLC</span>                    <span class="comment">\ Set angleHi = angleHi + A</span>
 <span class="mne">ADC</span> <a class="popup variable">angleHi</a>            <span class="comment">\</span>
 <span class="mne">STA</span> <a class="popup variable">angleHi</a>            <span class="comment">\ So this sets bits 6 and 7 of the angle correctly so it</span>
                        <span class="comment">\ is in the correct quadrant ???</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>

<span class="label">.ghyp8</span><a id="ghyp8" class="anchor"></a>

 <span class="mne">ASL</span> <a class="popup variable">xDeltaLo</a>           <span class="comment">\ Shift (xDeltaAbsoluteHi xDeltaLo) left by one place to</span>
 <span class="mne">ROL</span> <a class="popup variable">xDeltaAbsoluteHi</a>   <span class="comment">\ scale it up</span>

<span class="label">.ghyp9</span><a id="ghyp9" class="anchor"></a>

                        <span class="comment">\ If we jump here then:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * (zDeltaAbsoluteHi zDeltaLo) >=</span>
                        <span class="comment">\                            (xDeltaAbsoluteHi xDeltaLo)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * a(Hi Lo) is the longer side</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * b(Hi Lo) is the shorter side</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * A = zDeltaAbsoluteHi</span>
                        <span class="comment">\</span>
                        <span class="comment">\ The last one means that the length of the z-axis side</span>
                        <span class="comment">\ is currently in (A zDeltaLo)</span>

                        <span class="comment">\ We start by shifting the lengths of both sides to the</span>
                        <span class="comment">\ left until bit 7 of A is set</span>
                        <span class="comment">\</span>
                        <span class="comment">\ As we know that (A zDeltaLo) is the longest side, this</span>
                        <span class="comment">\ scales both lengths up by the same amount until they</span>
                        <span class="comment">\ are as large as they can be while still fitting into a</span>
                        <span class="comment">\ 16-bit number</span>

 <span class="mne">ASL</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ Shift (A zDeltaLo) left by one place to scale it up</span>
 <span class="mne">ROL</span> <span class="register">A</span>

 <span class="mne">BCC</span> <a class="popup destination">ghyp8</a>              <span class="comment">\ If we just shifted a zero out of bit 7 of (A zDeltaLo)</span>
                        <span class="comment">\ then jump back to ghyp8 to scale the z-axis length and</span>
                        <span class="comment">\ keep scaling until we shift a 1 out of bit 7, at which</span>
                        <span class="comment">\ point we will have scaled (A zDeltaLo) as far as we</span>
                        <span class="comment">\ can</span>

 <span class="mne">ROR</span> <span class="register">A</span>                  <span class="comment">\ Shift the 1 back into bit 7 of (A zDeltaLo) to undo</span>
 <span class="mne">ROR</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ the last left-shift, so (A zDeltaLo) is now as large</span>
                        <span class="comment">\ as it can be</span>

 <span class="mne">STA</span> <a class="popup variable">V</a>                  <span class="comment">\ Set V to the high byte of the scaled z-axis length</span>

 <span class="mne">LDA</span> <a class="popup variable">xDeltaLo</a>           <span class="comment">\ Set T to the low byte of the scaled x-axis length</span>
 <span class="mne">STA</span> <a class="popup variable">T</a>

 <span class="mne">LDA</span> <a class="popup variable">zDeltaLo</a>           <span class="comment">\ Set W to the low byte of the scaled z-axis length,</span>
 <span class="mne">AND</span> <span class="hash">#</span><span class="hex">&FC</span>               <span class="comment">\ with bits 0 and 1 cleared</span>
 <span class="mne">STA</span> <a class="popup variable">W</a>

 <span class="mne">LDA</span> <a class="popup variable">xDeltaAbsoluteHi</a>   <span class="comment">\ Set A to the high byte of the scaled x-axis length</span>

                        <span class="comment">\ So by this point we have:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * (A T) = the scaled x-axis length</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * (V W) = the scaled z-axis length</span>

 <span class="mne">JSR</span> <a class="popup destination">GetAngleFromCoords</a> <span class="comment">\ Calculate the following angle:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   angle(Hi Lo) = arctan( (A T) / (V W) )</span>
                        <span class="comment">\                = arctan( z-axis / x-axis )</span>
                        <span class="comment">\</span>
                        <span class="comment">\ This works because the z-axis length is greater than</span>
                        <span class="comment">\ the x-axis length, so the z-axis is the adjacent side</span>
                        <span class="comment">\ and the x-axis is the opposite side</span>

 <span class="mne">LDA</span> <a class="popup variable">xDeltaHi</a>           <span class="comment">\ If xDeltaHi and zDeltaHi have the same sign bits in</span>
 <span class="mne">EOR</span> <a class="popup variable">zDeltaHi</a>           <span class="comment">\ bit 7, then EOR'ing them will produce a 0, so jump to</span>
 <span class="mne">BPL</span> <a class="popup destination">ghyp10</a>             <span class="comment">\ ghyp10 to skip the following, as the sign of the angle</span>
                        <span class="comment">\ is already correct</span>
                        <span class="comment">\</span>
                        <span class="comment">\ This is because (z-axis / x-axis) will be positive as</span>
                        <span class="comment">\ both sides of the division have the same sign, and as</span>
                        <span class="comment">\ the arctangent of a positive value is also positive,</span>
                        <span class="comment">\ we know we have the correct sign</span>
                        <span class="comment">\</span>
                        <span class="comment">\ If each side of the division has a different sign then</span>
                        <span class="comment">\ (z-axis / x-axis) will be negative, and so will the</span>
                        <span class="comment">\ arctangent, so we need to negate the result</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Negate angle(Hi Lo) to give it the correct sign</span>
 <span class="mne">SEC</span>
 <span class="mne">SBC</span> <a class="popup variable">angleLo</a>
 <span class="mne">STA</span> <a class="popup variable">angleLo</a>
 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>
 <span class="mne">SBC</span> <a class="popup variable">angleHi</a>
 <span class="mne">STA</span> <a class="popup variable">angleHi</a>

<span class="label">.ghyp10</span><a id="ghyp10" class="anchor"></a>

                        <span class="comment">\ Finally, if the z-axis value is negative, then the</span>
                        <span class="comment">\ hypotenuse will be pointing in the opposite direction</span>
                        <span class="comment">\ to the z-axis (i.e. out of the screen rather than into</span>
                        <span class="comment">\ it), so we need to add 180 degrees to the angle, which</span>
                        <span class="comment">\ we can do by adding 128</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ If bit 7 of zDeltaHi is set then set A = 128 to add to</span>
 <span class="mne">BIT</span> <a class="popup variable">zDeltaHi</a>           <span class="comment">\ the final result below, otherwise set A = 0 to the</span>
 <span class="mne">BPL</span> <a class="popup destination">ghyp11</a>             <span class="comment">\ result is unchanged</span>
 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">128</span>

<span class="label">.ghyp11</span><a id="ghyp11" class="anchor"></a>

 <span class="mne">CLC</span>                    <span class="comment">\ Set angleHi = angleHi + A</span>
 <span class="mne">ADC</span> <a class="popup variable">angleHi</a>
 <span class="mne">STA</span> <a class="popup variable">angleHi</a>            <span class="comment">\ So this sets bits 6 and 7 of the angle correctly so it</span>
                        <span class="comment">\ is in the correct quadrant ???</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-getanglefromcoords"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/getanglefromcoords_part_1_of_3.html">GetAngleFromCoords (Part 1 of 3)</a> (category: Maths (Geometry))</div><div class="summary">Given the coordinates along two axes, calculate the pitch or yaw angle to those coordinates</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-t"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#t">T</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">Temporary storage, used in a number of places</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-v"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#v">V</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">Temporary storage, used in a number of places</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-w"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#w">W</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">Temporary storage, used in a number of places</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ahi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#ahi">aHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The high byte of the adjacent side of a triangle when calculating the hypotenuse</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-alo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#alo">aLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The low byte of the adjacent side of a triangle when calculating the hypotenuse</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-anglehi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#anglehi">angleHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The low byte of an angle</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-anglelo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#anglelo">angleLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The high byte of an angle</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-angletangent"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#angletangent">angleTangent</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The tangent of an angle in a right-angled triangle</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-bhi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#bhi">bHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The high byte of the opposite side of a triangle when calculating the hypotenuse</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-blo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#blo">bLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The low byte of the opposite side of a triangle when calculating the hypotenuse</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp1">ghyp1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp10"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp10">ghyp10</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp11"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp11">ghyp11</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp2">ghyp2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp3"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp3">ghyp3</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp4"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp4">ghyp4</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp5"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp5">ghyp5</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp6"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp6">ghyp6</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp7"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp7">ghyp7</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp8"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp8">ghyp8</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ghyp9"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/gethypotenuseangle.html#ghyp9">ghyp9</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xdeltaabsolutehi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xdeltaabsolutehi">xDeltaAbsoluteHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The absolute difference between two x-coordinates (high byte), i.e. |xDeltaHi|</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xdeltahi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xdeltahi">xDeltaHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The difference between two x-coordinates (high byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xdeltalo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xdeltalo">xDeltaLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The difference between two x-coordinates (low byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-zdeltaabsolutehi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#zdeltaabsolutehi">zDeltaAbsoluteHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The absolute difference between two z-coordinates (high byte), i.e. |zDeltaHi|</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-zdeltahi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#zdeltahi">zDeltaHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The difference between two z-coordinates (high byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-zdeltalo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#zdeltalo">zDeltaLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The difference between two z-coordinates (low byte)</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/drawviewyawhi.html">drawViewYawHi</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/getpitchangledelta.html">GetPitchAngleDelta</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
