<?php
include_once("../../../templates/template_functions.php");
page_header("drawing_objects", "subroutine_drawobject.html", "The DrawObject subroutine", "Drawing objects: DrawObject", "Annotated code for the DrawObject subroutine in The Sentinel", "the_sentinel-code", "source_drawing_objects", "subroutine_drawobject", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/getobjpointangles.html">GetObjPointAngles</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/gethorizontaldelta.html">GetHorizontalDelta</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">DrawObject</span>                                              <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Drawing objects</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Draw a 3D object</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_j.html#header-drawobject">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/drawobjectstack.html">DrawObjectStack</a> calls <a href="#drawobject">DrawObject</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/drawtileandobjects.html">DrawTileAndObjects</a> calls <a href="#drawobject">DrawObject</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/drawtitleobject.html">DrawTitleObject</a> calls <a href="#drawobject">DrawObject</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/drawupdatedobject.html">DrawUpdatedObject</a> calls <a href="#drawobject">DrawObject</a></span>
</div>
<hr class="light">
<span class="subheader"> Arguments:</span>

   <span class="argumentLabel">Y</span>                    <span class="argumentEntry">The number of the object to be drawn</span>

<hr class="light">
<span class="subheader"> Returns:</span>

   <span class="argumentLabel">Y</span>                    <span class="argumentEntry">Y is preserved</span>

</div></div>
<span class="label">.DrawObject</span><a id="drawobject" class="anchor"></a>

 <span class="mne">JSR</span> <a class="popup destination">GetObjectAngles</a>    <span class="comment">\ Calculate the angles and distances of the vector from</span>
                        <span class="comment">\ the viewer to object #Y and put them into the</span>
                        <span class="comment">\ following variables:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Set objectViewYaw(Hi Lo) to the yaw angle of the</span>
                        <span class="comment">\     viewer's gaze towards the object, relative to the</span>
                        <span class="comment">\     screen</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Set objectGazeYaw(Hi Lo) to the difference in yaw</span>
                        <span class="comment">\     angles between the viewer's gaze towards the</span>
                        <span class="comment">\     object and the object's gaze to wherever it is</span>
                        <span class="comment">\     looking (so that's the object's gaze relative to</span>
                        <span class="comment">\     the viewer's gaze)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Set hypotenuse(Hi Lo) to the length of the 3D</span>
                        <span class="comment">\     vector from the viewer to the object when</span>
                        <span class="comment">\     projected down onto the ground plane</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Set objectAdjacent(Hi Lo) to the length of the</span>
                        <span class="comment">\     adjacent side in the vertical right-angled</span>
                        <span class="comment">\     triangle with the projected vector along the</span>
                        <span class="comment">\     bottom and the vector from the viewer to the</span>
                        <span class="comment">\     object as the hypotenuse</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Set objectOpposite(Hi Lo) to the length of the</span>
                        <span class="comment">\     opposite side in the vertical right-angled</span>
                        <span class="comment">\     triangle with the projected vector along the</span>
                        <span class="comment">\     bottom and the vector from the viewer to the</span>
                        <span class="comment">\     object as the hypotenuse</span>
                        <span class="comment">\</span>
                        <span class="comment">\ Note that hypotenuse(Hi Lo) and objectAdjacent(Hi Lo)</span>
                        <span class="comment">\ are the same value, as the hypotenuse of the ground</span>
                        <span class="comment">\ plane triangle is the same as the adjacent side of the</span>
                        <span class="comment">\ vertical triangle</span>
                        <span class="comment">\</span>
                        <span class="comment">\ This also sets objectToAnalyse to the number of the</span>
                        <span class="comment">\ object that we are drawing</span>

 <span class="mne">LDA</span> <a class="popup variable">hypotenuseHi</a>       <span class="comment">\ If hypotenuseHi (i.e. objectAdjacentHi) is greater or</span>
 <span class="mne">CMP</span> <span class="hash">#</span><span class="decimal">15</span>                <span class="comment">\ equal to 15 then the object is a fair distance away</span>
 <span class="mne">ROR</span> <a class="popup variable">blendPolygonEdges</a>  <span class="comment">\ from the viewer along the z-axis, so set bit 7 of</span>
                        <span class="comment">\ blendPolygonEdges so we draw the polygon edges in the</span>
                        <span class="comment">\ same colour as the polygon body (i.e. the fill</span>
                        <span class="comment">\ colour), so the edges blend into the body</span>
                        <span class="comment">\</span>
                        <span class="comment">\ We do this for distant objects because distinct edge</span>
                        <span class="comment">\ colours can make those object look messy</span>

 <span class="mne">JSR</span> <a class="popup destination">GetObjPointAngles</a>  <span class="comment">\ Calculate the view-relative pitch and yaw angles of</span>
                        <span class="comment">\ all the points in the object and put them into the</span>
                        <span class="comment">\ drawing tables at:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   drawViewYaw(Hi Lo)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   drawViewPitch(Hi Lo)</span>
                        <span class="comment">\</span>
                        <span class="comment">\ We can use these as screen x- and y-coordinates, using</span>
                        <span class="comment">\ the same screen projection that is used in Revs</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="binary">%01000000</span>         <span class="comment">\ Clear bit 7 and set bit 6 of polygonType so the call</span>
 <span class="mne">STA</span> <a class="popup variable">polygonType</a>        <span class="comment">\ to DrawPolygon below draws the correct type of polygon</span>
                        <span class="comment">\ for being part of an object</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Set drawingPhaseCount = 0, so the default is to draw</span>
 <span class="mne">STA</span> <a class="popup variable">drawingPhaseCount</a>  <span class="comment">\ the object in one phase (we may change this later if</span>
                        <span class="comment">\ the object needs to be drawn in two phases)</span>

 <span class="mne">STA</span> <a class="popup variable">drawingPhase</a>       <span class="comment">\ Clear bit 7 of drawingPhase so for objects that need</span>
                        <span class="comment">\ two drawing phases, we start by drawing the first</span>
                        <span class="comment">\ phase (as the current phase is determined by bit 7)</span>

 <span class="mne">LDX</span> <a class="popup variable">objTypeToAnalyse</a>   <span class="comment">\ Set X to the number of the object we are drawing</span>

 <span class="mne">LDA</span> <a class="popup variable">objPolygonPhases</a>,<span class="register">X</span> <span class="comment">\ Set A to the phase data for the object we are drawing,</span>
                        <span class="comment">\ which helps determine the number of drawing phases</span>

 <span class="mne">BEQ</span> <a class="popup destination">drob4</a>              <span class="comment">\ If A = 0 then this object only has one drawing phase,</span>
                        <span class="comment">\ so jump to drob4 to move on to drawing the object</span>
                        <span class="comment">\ (this applies to the tree, the boulder, the Sentinel's</span>
                        <span class="comment">\ tower and the 3D text blocks)</span>

                        <span class="comment">\ If we get here then bit 1 of A must be set, as the</span>
                        <span class="comment">\ only values used in the objPolygonPhases table are</span>
                        <span class="comment">\ %00, %10 and %11</span>

 <span class="mne">LSR</span> <span class="register">A</span>                  <span class="comment">\ If bit 0 of A is set then this object might need two</span>
 <span class="mne">BCS</span> <a class="popup destination">drob1</a>              <span class="comment">\ drawing phases, so jump to drob1 to work out how many</span>
                        <span class="comment">\ phases are required by checking the relative altitude</span>
                        <span class="comment">\ of the object (this applies to the robot, the sentry</span>
                        <span class="comment">\ and the Sentinel)</span>

                        <span class="comment">\ If we get here then bit 0 of A is clear and bit 1 is</span>
                        <span class="comment">\ set, so we need to work out how many phases are</span>
                        <span class="comment">\ required by checking whether or not the object is</span>
                        <span class="comment">\ facing the viewer as given in the object's yaw angle</span>
                        <span class="comment">\ (this applies to the meanie only)</span>

 <span class="mne">LDA</span> <a class="popup variable">objectGazeYawHi</a>    <span class="comment">\ Set A to the object's gaze yaw angle + 192, to turn it</span>
 <span class="mne">ADC</span> <span class="hash">#</span><span class="decimal">192</span>               <span class="comment">\ anticlockwise (left) through 90 degrees for the phase</span>
                        <span class="comment">\ calculation (the addition works because the C flag is</span>
                        <span class="comment">\ clear, as we just passed through a BCS)</span>

 <span class="mne">JMP</span> <a class="popup destination">drob3</a>              <span class="comment">\ Jump to drob3 to set drawingPhaseCount to 0 or 2,</span>
                        <span class="comment">\ depending on the direction in which the meanie is now</span>
                        <span class="comment">\ facing:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * 0 = one phase if the meanie's gaze yaw angle is</span>
                        <span class="comment">\     positive after the rotation, which means it must</span>
                        <span class="comment">\     be facing towards the viewer (so we leave</span>
                        <span class="comment">\     drawingPhaseCount = 0)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * 2 = two phases if the meanie's gaze yaw angle is</span>
                        <span class="comment">\     negative after the rotation, which means it must</span>
                        <span class="comment">\     be facing away from the viewer (so we set the</span>
                        <span class="comment">\     drawingPhaseCount = 2)</span>

<span class="label">.drob1</span><a id="drob1" class="anchor"></a>

                        <span class="comment">\ If we get here then we are drawing a robot, a sentry</span>
                        <span class="comment">\ or the Sentinel, so we need to work out how many</span>
                        <span class="comment">\ drawing phases are required</span>

 <span class="mne">LDA</span> <a class="popup variable">objectOppositeHi</a>   <span class="comment">\ If objectOpposite(Hi Lo) has a non-zero high byte,</span>
 <span class="mne">BNE</span> <a class="popup destination">drob2</a>              <span class="comment">\ then jump to drob2 to:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Draw the object in two phases if objectOppositeHi</span>
                        <span class="comment">\     is positive (i.e. the object is reasonably far</span>
                        <span class="comment">\     above the viewer)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Draw the object in one phase if objectOppositeHi</span>
                        <span class="comment">\     is negative (i.e. the object is below the viewer)</span>

 <span class="mne">LDA</span> <a class="popup variable">objectOppositeLo</a>   <span class="comment">\ If objectOpposite(Hi Lo) = 0 then the object is at the</span>
 <span class="mne">BEQ</span> <a class="popup destination">drob4</a>              <span class="comment">\ same height as the viewer, so jump to drob4 to draw</span>
                        <span class="comment">\ the object in one phase (by leaving drawingPhaseCount</span>
                        <span class="comment">\ set to 0)</span>

                        <span class="comment">\ If we get here then objectOppositeHi is zero but</span>
                        <span class="comment">\ objectOppositeLo is non-zero, so the object is only a</span>
                        <span class="comment">\ little bit above the viewer and we draw the object in</span>
                        <span class="comment">\ two phases (so now we set drawingPhaseCount = 2)</span>

 <span class="mne">LSR</span> <span class="register">A</span>                  <span class="comment">\ Clear bit 7 of A, so the following EOR instruction</span>
                        <span class="comment">\ will set bit 7, so we pass through the BPL instruction</span>
                        <span class="comment">\ and set drawingPhaseCount = 2 before falling through</span>
                        <span class="comment">\ into drob4 to do the actual drawing</span>

<span class="label">.drob2</span><a id="drob2" class="anchor"></a>

 <span class="mne">EOR</span> <span class="hash">#</span><span class="binary">%10000000</span>         <span class="comment">\ Flip bit 7 of A, which will contain objectOppositeHi</span>
                        <span class="comment">\ if we jumped here from the BNE above</span>

<span class="label">.drob3</span><a id="drob3" class="anchor"></a>

 <span class="mne">BPL</span> <a class="popup destination">drob4</a>              <span class="comment">\ If we jumped here because we are drawing a meanie,</span>
                        <span class="comment">\ then this jumps to drob4 if the updated object's gaze</span>
                        <span class="comment">\ yaw angle is positive</span>
                        <span class="comment">\</span>
                        <span class="comment">\ If we fell through from drob2, then this jumps to</span>
                        <span class="comment">\ drob4 if bit 7 of objectOppositeHi is set, i.e. if</span>
                        <span class="comment">\ objectOpposite(Hi Lo) is negative</span>

                        <span class="comment">\ If we get here then one of these is true:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * We are drawing a meanie and it is facing away from</span>
                        <span class="comment">\     the viewer</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * We are drawing a robot, a sentry or the Sentinel</span>
                        <span class="comment">\     and one of these is true:</span>
                        <span class="comment">\</span>
                        <span class="comment">\     * objectOpposite(Hi Lo) is positive and</span>
                        <span class="comment">\       objectOppositeHi > 0 (so the object is</span>
                        <span class="comment">\       reasonably far above the viewer)</span>
                        <span class="comment">\</span>
                        <span class="comment">\     * objectOppositeHi is zero and objectOppositeLo is</span>
                        <span class="comment">\       non-zero (so the object is a little bit above</span>
                        <span class="comment">\       the viewer)</span>
                        <span class="comment">\</span>
                        <span class="comment">\     In other words we are drawing a robot, a sentry or</span>
                        <span class="comment">\     the Sentinel and the object is above the viewer</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">2</span>                 <span class="comment">\ Set drawingPhaseCount = 2 so we draw the object in two</span>
 <span class="mne">STA</span> <a class="popup variable">drawingPhaseCount</a>  <span class="comment">\ phases</span>

<span class="label">.drob4</span><a id="drob4" class="anchor"></a>

 <span class="mne">LDX</span> <a class="popup variable">objTypeToAnalyse</a>   <span class="comment">\ Set X to the number of the object we are drawing</span>

 <span class="mne">LDA</span> <a class="popup variable">objPolygonRange</a><span class="operator">+</span><span class="decimal">1</span>,<span class="register">X</span>    <span class="comment">\ Set objectLastPolygon to entry X + 1 from the</span>
 <span class="mne">STA</span> <a class="popup variable">objectLastPolygon</a>      <span class="comment">\ table at objPolygonRange, so this now contains the</span>
                            <span class="comment">\ number of the first polygon for the next object,</span>
                            <span class="comment">\ object #X + 1, which is one greater than the last</span>
                            <span class="comment">\ polygon number for object #X, as the lists of</span>
                            <span class="comment">\ object polygons are sequential (so object #0's</span>
                            <span class="comment">\ polygons are first in the object data tables, then</span>
                            <span class="comment">\ object #1's polygons, and so on)</span>

 <span class="mne">LDY</span> <a class="popup variable">objPolygonRange</a>,<span class="register">X</span>  <span class="comment">\ Set Y to entry X from the table at objPolygonRange, so</span>
                        <span class="comment">\ so this now contains the number of the first polygon</span>
                        <span class="comment">\ for object #X</span>
                        <span class="comment">\</span>
                        <span class="comment">\ This means that in the following loop, we start the</span>
                        <span class="comment">\ drawing process with the first polygon for object #X</span>

<span class="label">.drob5</span><a id="drob5" class="anchor"></a>

 <span class="mne">STY</span> <a class="popup variable">polygonNumber</a>      <span class="comment">\ Set polygonNumber to Y, so we start from the first</span>
                        <span class="comment">\ polygon and work through them in order</span>

 <span class="mne">LDA</span> <a class="popup variable">objPolygonData</a>,<span class="register">Y</span>   <span class="comment">\ Set A to the polygon data byte for the polygon we are</span>
                        <span class="comment">\ drawing</span>

 <span class="mne">LDX</span> <a class="popup variable">drawingPhaseCount</a>  <span class="comment">\ If drawingPhaseCount = 0 then jump to drob6 to skip</span>
 <span class="mne">BEQ</span> <a class="popup destination">drob6</a>              <span class="comment">\ the following, as there is only one drawing phase for</span>
                        <span class="comment">\ this object</span>

 <span class="mne">EOR</span> <a class="popup variable">drawingPhase</a>       <span class="comment">\ If bit 7 of the polygon data byte does not match bit 7</span>
 <span class="mne">BMI</span> <a class="popup destination">drob7</a>              <span class="comment">\ of drawingPhase, then we do not draw this polygon in</span>
                        <span class="comment">\ this phase, so jump to drob7 to skip drawing the</span>
                        <span class="comment">\ polygon and move on to the next one</span>

                        <span class="comment">\ If we get here then bit 7 of the polygon data byte</span>
                        <span class="comment">\ matches the phase we are currently drawing, so we draw</span>
                        <span class="comment">\ the polygon</span>

<span class="label">.drob6</span><a id="drob6" class="anchor"></a>

 <span class="mne">AND</span> <span class="hash">#</span><span class="binary">%00111100</span>         <span class="comment">\ Extract bits 2 to 5 from the polygon data byte to get</span>
 <span class="mne">STA</span> <a class="popup variable">polygonColours</a>     <span class="comment">\ the polygon's edge and fill colours, and put them into</span>
                        <span class="comment">\ polygonColours</span>

 <span class="mne">LDA</span> <a class="popup variable">objPolygonData</a>,<span class="register">Y</span>   <span class="comment">\ Set A to the polygon data byte for the polygon we are</span>
                        <span class="comment">\ drawing</span>

 <span class="mne">AND</span> <span class="hash">#</span><span class="binary">%00000011</span>         <span class="comment">\ Extract bits 0 to 1 from the polygon data byte to get</span>
 <span class="mne">CLC</span>                    <span class="comment">\ the number of sides in the polygon (where 0 means</span>
 <span class="mne">ADC</span> <span class="hash">#</span><span class="decimal">3</span>                 <span class="comment">\ three sides and 1 means four sides)</span>
 <span class="mne">STA</span> <a class="popup variable">polygonEdgeCount</a>   <span class="comment">\</span>
                        <span class="comment">\ Then add 3 to get the number of sides in the polygon,</span>
                        <span class="comment">\ (three for a triangle or four for a quadrilateral)</span>
                        <span class="comment">\ and store the result in polygonEdgeCount</span>

 <span class="mne">LDA</span> <a class="popup variable">objPolygonAddrLo</a>,<span class="register">Y</span> <span class="comment">\ Set drawViewAngles(1 0) to the address of the list of</span>
 <span class="mne">STA</span> <a class="popup variable">drawViewAngles</a>     <span class="comment">\ object-relative point numbers for this polygon so the</span>
 <span class="mne">LDA</span> <a class="popup variable">objPolygonAddrHi</a>,<span class="register">Y</span> <span class="comment">\ DrawPolygon routine can use the yaw and pitch angles</span>
 <span class="mne">STA</span> <a class="popup variable">drawViewAngles</a><span class="operator">+</span><span class="decimal">1</span>   <span class="comment">\ that we calculated for the object points in the</span>
                        <span class="comment">\ GetObjPointAngles routine</span>

 <span class="mne">JSR</span> <a class="popup destination">DrawPolygon</a>        <span class="comment">\ Draw the polygon</span>

 <span class="mne">LDY</span> <a class="popup variable">polygonNumber</a>      <span class="comment">\ Set Y to the polygon number once again, as the call</span>
                        <span class="comment">\ to DrawPolygon will have corrupted it</span>

<span class="label">.drob7</span><a id="drob7" class="anchor"></a>

 <span class="mne">INY</span>                    <span class="comment">\ Increment the polygon number in Y</span>

 <span class="mne">CPY</span> <a class="popup variable">objectLastPolygon</a>  <span class="comment">\ If we have not yet reached the end of the list, loop</span>
 <span class="mne">BCC</span> <a class="popup destination">drob5</a>              <span class="comment">\ back to drob5 to draw the next polygon, until we have</span>
                        <span class="comment">\ processed all the polygons in the object</span>

 <span class="mne">DEC</span> <a class="popup variable">drawingPhaseCount</a>  <span class="comment">\ Decrement the drawing phase counter</span>

 <span class="mne">BMI</span> <a class="popup destination">drob8</a>              <span class="comment">\ If drawingPhaseCount was zero before being decremented</span>
                        <span class="comment">\ then there is only one drawing phase, so jump to drob8</span>
                        <span class="comment">\ to finish up</span>

 <span class="mne">BEQ</span> <a class="popup destination">drob8</a>              <span class="comment">\ If drawingPhaseCount was 1 before being decremented</span>
                        <span class="comment">\ then there are two drawing phases and we have just</span>
                        <span class="comment">\ finished drawing the second phase, so jump to drob8 to</span>
                        <span class="comment">\ finish up</span>

                        <span class="comment">\ If we get here then drawingPhaseCount was 2 before</span>
                        <span class="comment">\ being decremented, so this is a two-phase object and</span>
                        <span class="comment">\ we have only drawn the first phase, so now we draw the</span>
                        <span class="comment">\ second phase</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="binary">%10000000</span>         <span class="comment">\ Set bit 7 of drawingPhase so we now draw the second</span>
 <span class="mne">STA</span> <a class="popup variable">drawingPhase</a>       <span class="comment">\ phase</span>

 <span class="mne">BMI</span> <a class="popup destination">drob4</a>              <span class="comment">\ Jump back to drob4 to draw the second phase for the</span>
                        <span class="comment">\ two-phase object</span>

<span class="label">.drob8</span><a id="drob8" class="anchor"></a>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="operator">LO</span><span class="bracket">(</span><a class="popup variable">polygonPoint</a><span class="bracket">)</span>  <span class="comment">\ Set drawViewAngles(1 0) = polygonPoint</span>
 <span class="mne">STA</span> <a class="popup variable">drawViewAngles</a>     <span class="comment">\</span>
 <span class="mne">LDA</span> <span class="hash">#</span><span class="operator">HI</span><span class="bracket">(</span><a class="popup variable">polygonPoint</a><span class="bracket">)</span>  <span class="comment">\ This resets drawViewAngles(1 0) so DrawPolygon will</span>
 <span class="mne">STA</span> <a class="popup variable">drawViewAngles</a><span class="operator">+</span><span class="decimal">1</span>   <span class="comment">\ return to the default behaviour of drawing using point</span>
                        <span class="comment">\ data for tile faces rather than object polygons</span>

 <span class="mne">LSR</span> <a class="popup variable">blendPolygonEdges</a>  <span class="comment">\ Clear bit 7 of blendPolygonEdges so we return to the</span>
                        <span class="comment">\ default setting of allowing drawing polygon edges to</span>
                        <span class="comment">\ be a different colour to the polygon fill</span>

 <span class="mne">LDY</span> <a class="popup variable">objectToAnalyse</a>    <span class="comment">\ Set Y to the number of the object we just drew, so it</span>
                        <span class="comment">\ is preserved</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawpolygon"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/drawpolygon.html">DrawPolygon</a> (category: Drawing polygons)</div><div class="summary">Draw a polygon</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-getobjpointangles"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/getobjpointangles.html">GetObjPointAngles</a> (category: Drawing objects)</div><div class="summary">Calculate the view-relative pitch and yaw angles of all the points in an object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-getobjectangles"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/getobjectangles.html">GetObjectAngles</a> (category: 3D objects)</div><div class="summary">Calculate the angles and distances of the vector from the viewer to a specific object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-blendpolygonedges"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#blendpolygonedges">blendPolygonEdges</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to determine whether polygon edges are drawn in the same colour as the polygon fill, thus blending the edges into the polygon body</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawviewangles"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#drawviewangles">drawViewAngles</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The address in drawViewAngles(1 0) of the pitch and yaw angles of the tile and polygon points that we are drawing in the landscape view</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawingphase"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#drawingphase">drawingPhase</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The number of the current drawing phase when drawing two-phase objects</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawingphasecount"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#drawingphasecount">drawingPhaseCount</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">A phase counter for objects that need to be drawn in multiple phases</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob1">drob1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob2">drob2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob3"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob3">drob3</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob4"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob4">drob4</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob5"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob5">drob5</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob6"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob6">drob6</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob7"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob7">drob7</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drob8"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawobject.html#drob8">drob8</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-hypotenusehi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#hypotenusehi">hypotenuseHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The high byte of the hypotenuse of a triangle</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objpolygonaddrhi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/objpolygonaddrhi.html">objPolygonAddrHi</a> (category: Drawing objects)</div><div class="summary">Addresses for the list of polygons and points for each object (high byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objpolygonaddrlo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/objpolygonaddrlo.html">objPolygonAddrLo</a> (category: Drawing objects)</div><div class="summary">Addresses for the list of polygons and points for each object (low byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objpolygondata"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/objpolygondata.html">objPolygonData</a> (category: Drawing objects)</div><div class="summary">Various data for object polygons (colour, drawing phase)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objpolygonphases"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/objpolygonphases.html">objPolygonPhases</a> (category: Drawing objects)</div><div class="summary">The phase configuration for each object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objpolygonrange"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/objpolygonrange.html">objPolygonRange</a> (category: Drawing objects)</div><div class="summary">The first and last polygon numbers for each object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objtypetoanalyse"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#objtypetoanalyse">objTypeToAnalyse</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The type of the object being analysed in the GetObjectAngles routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objectgazeyawhi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#objectgazeyawhi">objectGazeYawHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The difference in the yaw angle of the viewer's gaze and the yaw angle (i.e. the gaze) of the object being analysed (low byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objectlastpolygon"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#objectlastpolygon">objectLastPolygon</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The number of the last polygon in the object being drawn</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objectoppositehi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#objectoppositehi">objectOppositeHi</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The height of an object relative to the viewer, expressed as the length of the opposite side in a triangle with the vector from the viewer to the object as the hypotenuse (high byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objectoppositelo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#objectoppositelo">objectOppositeLo</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The height of an object relative to the viewer, expressed as the length of the opposite side in a triangle with the vector from the viewer to the object as the hypotenuse (low byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objecttoanalyse"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#objecttoanalyse">objectToAnalyse</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The number of the object to analyse in the GetObjectAngles routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-polygoncolours"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#polygoncolours">polygonColours</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The colours of the polygon that's being drawn in the DrawPolygon routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-polygonedgecount"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#polygonedgecount">polygonEdgeCount</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The number of sides in the polygon we are drawing, which is one less than the number of points in the polygon's point list (as the last point in the list is always a repeat of the first point)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-polygonnumber"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#polygonnumber">polygonNumber</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">A counter for the polygon number as we work through the polygons in an object when drawing the object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-polygonpoint"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#polygonpoint">polygonPoint</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Up to five coordinates for the points of the polygon being drawn</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-polygontype"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#polygontype">polygonType</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">Bits 6 and 7 determine the type of polygon to draw in the DrawPolygon routine (the calling subroutine is in brackets)</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/getobjpointangles.html">GetObjPointAngles</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/gethorizontaldelta.html">GetHorizontalDelta</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
