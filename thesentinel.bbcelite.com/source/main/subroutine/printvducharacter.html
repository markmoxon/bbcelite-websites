<?php
include_once("../../../templates/template_functions.php");
page_header("text", "subroutine_printvducharacter.html", "The PrintVduCharacter subroutine", "Text: PrintVduCharacter", "Annotated code for the PrintVduCharacter subroutine in The Sentinel", "the_sentinel-code", "source_text", "subroutine_printvducharacter", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/printcharacter.html">PrintCharacter</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/vducounter.html">vduCounter</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">PrintVduCharacter</span>                                       <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Text</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Print a one-byte character from a text token or a multi-byte</span>
             <span class="headerEntry">VDU 25 command</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_i.html#header-printvducharacter">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/processcharacter.html">ProcessCharacter</a> calls <a href="#printvducharacter">PrintVduCharacter</a></span>
</div>
<hr class="light">
<span class="subheader"> Arguments:</span>

   <span class="argumentLabel">A</span>                    <span class="argumentEntry">The character to be printed</span>

   <span class="argumentLabel">Y</span>                    <span class="argumentEntry">The offset of the current character within the text</span>
                        <span class="argumentEntry">token being printed</span>

</div></div>
<span class="label">.PrintVduCharacter</span><a id="printvducharacter" class="anchor"></a>

 <span class="mne">CMP</span> <span class="hash">#</span><span class="decimal">25</span>                <span class="comment">\ If the character in A = 25, jump to prin2 to print a</span>
 <span class="mne">BEQ</span> <a class="popup destination">prin2</a>              <span class="comment">\ six-byte command in the form VDU 25, n, x; y;</span>
                        <span class="comment">\</span>
                        <span class="comment">\ We print the VDU 25 commands in its own loop because</span>
                        <span class="comment">\ the 16-bit arguments to the command (x and y) might</span>
                        <span class="comment">\ contain &FF, and we don't want this to be</span>
                        <span class="comment">\ misidentified as the end of the text token</span>

 <span class="mne">JMP</span> <a class="popup destination">PrintCharacter</a>     <span class="comment">\ Otherwise jump to PrintCharacter to print the single-</span>
                        <span class="comment">\ byte VDU command or character in A, returning from the</span>
                        <span class="comment">\ subroutine using a tail call</span>

<span class="label">.prin1</span><a id="prin1" class="anchor"></a>

 <span class="mne">INY</span>                    <span class="comment">\ Increment the offset of the character being printed to</span>
                        <span class="comment">\ move on to the next character in the token</span>

 <span class="mne">LDA</span> <a class="popup variable">tokenBase</a>,<span class="register">Y</span>        <span class="comment">\ Set A to the next character to print</span>

<span class="label">.prin2</span><a id="prin2" class="anchor"></a>

 <span class="mne">JSR</span> <a class="popup destination">OSWRCH</a>             <span class="comment">\ Print the next character in the VDU 25 command (we</span>
                        <span class="comment">\ jump here from above with A = 25, which starts off</span>
                        <span class="comment">\ the six-byte VDU sequence)</span>

 <span class="mne">DEC</span> <a class="popup variable">vduCounter</a>         <span class="comment">\ Decrement the byte counter in vduCounter, which is</span>
                        <span class="comment">\ always 6 when we jump into this loop</span>

 <span class="mne">BNE</span> <a class="popup destination">prin1</a>              <span class="comment">\ Loop back to print the next character until we have</span>
                        <span class="comment">\ printed the whole VDU 25 command</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">6</span>                 <span class="comment">\ Reset the byte counter in vduCounter to 6, ready for</span>
 <span class="mne">STA</span> <a class="popup variable">vduCounter</a>         <span class="comment">\ the next time we perform a VDU 25 command</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-oswrch"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Configuration variable <a href="/source/all/workspaces.html#oswrch">OSWRCH</a> = &FFEE</div><div class="summary">The address for the OSWRCH routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-printcharacter"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/printcharacter.html">PrintCharacter</a> (category: Text)</div><div class="summary">Print a single-byte VDU command or character from a text token, optionally printing a drop shadow if the character is alphanumeric</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-prin1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/printvducharacter.html#prin1">prin1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-prin2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/printvducharacter.html#prin2">prin2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-tokenbase"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/variable/tokenoffset.html#tokenbase">tokenBase</a> in variable <a href="/source/main/variable/tokenoffset.html">tokenOffset</a></div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-vducounter"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/vducounter.html">vduCounter</a> (category: Text)</div><div class="summary">The number of bytes in a VDU 25, n, x; y; command</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/printcharacter.html">PrintCharacter</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/vducounter.html">vduCounter</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
