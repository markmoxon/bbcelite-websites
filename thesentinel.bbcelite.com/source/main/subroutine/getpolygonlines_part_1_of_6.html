<?php
include_once("../../../templates/template_functions.php");
page_header("drawing_polygons", "subroutine_getpolygonlines_part_1_of_6.html", "The GetPolygonLines (Part 1 of 6) subroutine", "Drawing polygons: GetPolygonLines (Part 1 of 6)", "Annotated code for the GetPolygonLines (Part 1 of 6) subroutine in The Sentinel", "the_sentinel-code", "source_drawing_polygons", "subroutine_getpolygonlines_part_1_of_6", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/trianglestart.html">triangleStart</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/getpolygonlines_part_2_of_6.html">GetPolygonLines (Part 2 of 6)</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">GetPolygonLines (Part 1 of 6)</span>                           <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Drawing polygons</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Calculate the points in a two-face tile polygon when it consists</span>
             <span class="headerEntry">of a pair of triangles</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_f.html#header-getpolygonlines-part-1-of-6">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">No direct references to this subroutine in this source file</span>
</div>
</div></div>
<span class="label">.gpol1</span><a id="gpol1" class="anchor"></a>

                        <span class="comment">\ If we get here then we are drawing a two-face tile as</span>
                        <span class="comment">\ a pair of triangles and A contains the offset of the</span>
                        <span class="comment">\ rear left tile corner in the drawing tables</span>

                        <span class="comment">\ For a triangle, we number the points like this: ???</span>
                        <span class="comment">\</span>
                        <span class="comment">\   1. Rear left</span>
                        <span class="comment">\                        3. Point 2 + trianglePointAdd,Y</span>
                        <span class="comment">\   2. Front left</span>
                        <span class="comment">\</span>
                        <span class="comment">\ We also set point 4 to be the same as point 1, so that</span>
                        <span class="comment">\ the third edge from point 3 to point 4 is effectively</span>
                        <span class="comment">\ from point 3 to point 1</span>

 <span class="mne">LDY</span> <a class="popup variable">triangleStartPoint</a> <span class="comment">\ Set Y to the number of the starting point for this</span>
                        <span class="comment">\ tile shape ???</span>

 <span class="mne">BVC</span> <a class="popup destination">gpol2</a>              <span class="comment">\ If bit 6 of polygonType is clear then we are drawing</span>
                        <span class="comment">\ the first triangle in a two-face tile, so jump to</span>
                        <span class="comment">\ gpol2 to do this</span>

                        <span class="comment">\ If we get here then bit 6 and 7 of polygonType are</span>
                        <span class="comment">\ both set, so we are drawing the second triangle in a</span>
                        <span class="comment">\ two-face file</span>

 <span class="mne">CLC</span>                    <span class="comment">\ Set A = (A + 32 + 1) mod 64</span>
 <span class="mne">ADC</span> <span class="hash">#</span><span class="decimal">33</span>                <span class="comment">\</span>
 <span class="mne">AND</span> <span class="hash">#</span><span class="decimal">63</span>                <span class="comment">\ So this moves diagonally from top-left to bottom-right</span>
                        <span class="comment">\ or bottom-left to top-right:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   offset x          offset x + 1</span>
                        <span class="comment">\</span>
                        <span class="comment">\   offset 32 + x     offset 32 + x + 1</span>
                        <span class="comment">\</span>
                        <span class="comment">\ ???</span>

 <span class="mne">INY</span>                    <span class="comment">\ Set Y = Y + 2</span>
 <span class="mne">INY</span>                    <span class="comment">\</span>
                        <span class="comment">\ to give 2 or 3 ???</span>

<span class="label">.gpol2</span><a id="gpol2" class="anchor"></a>

 <span class="mne">STA</span> <a class="popup variable">polygonPoint</a>       <span class="comment">\ Set the first triangle point to A</span>

 <span class="mne">STA</span> <a class="popup variable">polygonPoint</a><span class="operator">+</span><span class="decimal">3</span>     <span class="comment">\ Set the fourth triangle point to A, so the third edge</span>
                        <span class="comment">\ in the triangle joins with the start of the first</span>
                        <span class="comment">\ edge</span>

 <span class="mne">EOR</span> <span class="hash">#</span><span class="decimal">32</span>                <span class="comment">\ Set the second triangle point to the equivalent to A</span>
 <span class="mne">STA</span> <a class="popup variable">polygonPoint</a><span class="operator">+</span><span class="decimal">1</span>     <span class="comment">\ but in the other drawing table offset</span>

 <span class="mne">CLC</span>                    <span class="comment">\ Set the third triangle point to A + the Y-th entry</span>
 <span class="mne">ADC</span> <a class="popup variable">trianglePointAdd</a>,<span class="register">Y</span> <span class="comment">\ from trianglePointAdd, mod 64 ???</span>
 <span class="mne">AND</span> <span class="hash">#</span><span class="decimal">63</span>
 <span class="mne">STA</span> <a class="popup variable">polygonPoint</a><span class="operator">+</span><span class="decimal">2</span>

 <span class="mne">LDX</span> <span class="hash">#</span><span class="decimal">3</span>                 <span class="comment">\ Set X = 3 to set as the value of polygonEdgeCount as</span>
                        <span class="comment">\ there are three edges in a triangle polygon</span>

 <span class="mne">BNE</span> <a class="popup destination">gpol3</a>              <span class="comment">\ Jump to gpol3 in part 1 to set polygonEdgeCount = 3</span>
                        <span class="comment">\ and move on to part 4</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-gpol2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/getpolygonlines_part_1_of_6.html#gpol2">gpol2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-gpol3"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/getpolygonlines_part_2_of_6.html#gpol3">gpol3</a> in subroutine <a href="/source/main/subroutine/getpolygonlines_part_2_of_6.html">GetPolygonLines (Part 2 of 6)</a></div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-polygonpoint"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#polygonpoint">polygonPoint</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Up to five coordinates for the points of the polygon being drawn</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-trianglepointadd"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/trianglepointadd.html">trianglePointAdd</a> (category: Drawing polygons)</div><div class="summary">The value to add to the second point number to get the third point number when drawing a tile face as two triangles</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-trianglestartpoint"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#trianglestartpoint">triangleStartPoint</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The number of the starting point for the tile shape being drawn</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/trianglestart.html">triangleStart</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/getpolygonlines_part_2_of_6.html">GetPolygonLines (Part 2 of 6)</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
