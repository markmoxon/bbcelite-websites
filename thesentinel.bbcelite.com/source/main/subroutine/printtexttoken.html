<?php
include_once("../../../templates/template_functions.php");
page_header("text", "subroutine_printtexttoken.html", "The PrintTextToken subroutine", "Text: PrintTextToken", "Annotated code for the PrintTextToken subroutine in The Sentinel", "the_sentinel-code", "source_text", "subroutine_printtexttoken", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/cleariconsscanner.html">ClearIconsScanner</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/clearpixelmask.html">clearPixelMask</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">PrintTextToken</span>                                          <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Text</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Print a recursive text token</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_g.html#header-printtexttoken">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/finishlandscape.html">FinishLandscape</a> calls <a href="#printtexttoken">PrintTextToken</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/maingameloop.html">MainGameLoop</a> calls <a href="#printtexttoken">PrintTextToken</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/maintitleloop.html">MainTitleLoop</a> calls <a href="#printtexttoken">PrintTextToken</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/previewlandscape.html">PreviewLandscape</a> calls <a href="#printtexttoken">PrintTextToken</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/processcharacter.html">ProcessCharacter</a> calls <a href="#printtexttoken">PrintTextToken</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/secretcodeerror.html">SecretCodeError</a> calls <a href="#printtexttoken">PrintTextToken</a></span>
</div>
<hr class="light">
<span class="subheader"> Arguments:</span>

   <span class="argumentLabel">X</span>                    <span class="argumentEntry">The number of the text token to print (0 to 17)</span>

</div></div>
<span class="label">.PrintTextToken</span><a id="printtexttoken" class="anchor"></a>

 <span class="mne">LDY</span> <a class="popup variable">tokenOffset</a>,<span class="register">X</span>      <span class="comment">\ Set Y to the offset for text token X, which we can use</span>
                        <span class="comment">\ as a character index to print each character in turn</span>

<span class="label">.text1</span><a id="text1" class="anchor"></a>

 <span class="mne">LDA</span> <a class="popup variable">tokenBase</a>,<span class="register">Y</span>        <span class="comment">\ Set A to the Y-th character of the text token</span>

 <span class="mne">CMP</span> <span class="hash">#</span><span class="hex">&FF</span>               <span class="comment">\ If A = &FF then we have reached the end of the token,</span>
 <span class="mne">BEQ</span> <a class="popup destination">text2</a>              <span class="comment">\ so jump to text2 to return from the subroutine</span>

 <span class="mne">JSR</span> <a class="popup destination">ProcessCharacter</a>   <span class="comment">\ Process the Y-th character of the text token in A, so</span>
                        <span class="comment">\ if A is a token number in the format 200 + token, we</span>
                        <span class="comment">\ print the text token, otherwise we print A as a simple</span>
                        <span class="comment">\ one-byte character</span>

 <span class="mne">INY</span>                    <span class="comment">\ Increment the character index in Y to point to the</span>
                        <span class="comment">\ next character of the text token</span>

 <span class="mne">JMP</span> <a class="popup destination">text1</a>              <span class="comment">\ Loop back to print the next character</span>

<span class="label">.text2</span><a id="text2" class="anchor"></a>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-processcharacter"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/processcharacter.html">ProcessCharacter</a> (category: Text)</div><div class="summary">Process and print a character from a text token, which can encode another text token or be a one-byte character or VDU command</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-text1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/printtexttoken.html#text1">text1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-text2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/printtexttoken.html#text2">text2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-tokenbase"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/variable/tokenoffset.html#tokenbase">tokenBase</a> in variable <a href="/source/main/variable/tokenoffset.html">tokenOffset</a></div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-tokenoffset"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/tokenoffset.html">tokenOffset</a> (category: Text)</div><div class="summary">Address offsets for the text tokens (each offset in the table is the offset of the token from tokenBase)</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/cleariconsscanner.html">ClearIconsScanner</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/clearpixelmask.html">clearPixelMask</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
