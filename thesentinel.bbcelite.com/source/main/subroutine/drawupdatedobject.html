<?php
include_once("../../../templates/template_functions.php");
page_header("drawing_objects", "subroutine_drawupdatedobject.html", "The DrawUpdatedObject subroutine", "Drawing objects: DrawUpdatedObject", "Annotated code for the DrawUpdatedObject subroutine in The Sentinel", "the_sentinel-code", "source_drawing_objects", "subroutine_drawupdatedobject", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/tilenumber.html">tileNumber</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/screenbufferaddr.html">screenBufferAddr</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">DrawUpdatedObject</span>                                       <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Drawing objects</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Draw an updated object on-screen, optionally with a dithered</span>
             <span class="headerEntry">effect, and with or without the surrounding landscape</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_d.html#header-drawupdatedobject">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/applytactics_part_8_of_8.html">ApplyTactics (Part 8 of 8)</a> calls <a href="#drawupdatedobject">DrawUpdatedObject</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/processgameplay.html">ProcessGameplay</a> calls <a href="#drawupdatedobject">DrawUpdatedObject</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/showgameoverscreen.html">ShowGameOverScreen</a> calls <a href="#drawupdatedobject">DrawUpdatedObject</a></span>
</div>
<hr class="light">
<span class="subheader"> Arguments:</span>

   <span class="argumentLabel">currentObject</span>        <span class="argumentEntry">The number of the object to update on-screen</span>

   <span class="argumentLabel">viewingObject</span>        <span class="argumentEntry">The number of the object that's viewing the object that</span>
                        <span class="argumentEntry">we are updating</span>

   <span class="argumentLabel">drawLandscape</span>        <span class="argumentEntry">Configure whether to draw the landscape behind the</span>
                        <span class="argumentEntry">object:</span>

                        <span class="argumentEntry">  * Bit 7 clear = draw the landscape behind the object</span>
                        <span class="argumentEntry">                  as well as the object</span>

                        <span class="argumentEntry">  * Bit 7 set = just draw the object, and configure the</span>
                        <span class="argumentEntry">                interrupt handler to draw random black</span>
                        <span class="argumentEntry">                dots on the screen if the Sentinel has</span>
                        <span class="argumentEntry">                won the game</span>

   <span class="argumentLabel">ditherObjectSights</span>   <span class="argumentEntry">Configure how the update is drawn onto the screen:</span>

                        <span class="argumentEntry">  * Bit 6 set = dither the updated object onto the</span>
                        <span class="argumentEntry">                screen</span>

                        <span class="argumentEntry">  * Bit 7 set = remove the sights from the screen</span>
                        <span class="argumentEntry">                before drawing the object</span>

   <span class="argumentLabel">screenBackground</span>     <span class="argumentEntry">The screen background to use when drawing the object:</span>

                        <span class="argumentEntry">  * 0 = fill with alternating colour 0/1 (blue/black)</span>
                        <span class="argumentEntry">        pixel rows, for the sky during gameplay</span>

                        <span class="argumentEntry">  * 3 = fill with solid colour 1 (black) and draw 240</span>
                        <span class="argumentEntry">        randomly positioned stars on the background,</span>
                        <span class="argumentEntry">        for the game over screen</span>

</div></div>
<span class="label">.updo1</span><a id="updo1" class="anchor"></a>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="binary">%00000000</span>         <span class="comment">\ Clear bits 6 and 7 of ditherObjectSights so the next</span>
 <span class="mne">STA</span> <a class="popup variable">ditherObjectSights</a> <span class="comment">\ call to DrawUpdatedObject will, by default, draw the</span>
                        <span class="comment">\ object straight onto the screen without a dithered</span>
                        <span class="comment">\ effect, and will not remove the sights first</span>

 <span class="mne">STA</span> <a class="popup variable">drawLandscape</a>      <span class="comment">\ Clear bit 7 of drawLandscape so the next call to</span>
                        <span class="comment">\ DrawUpdatedObject will, by default, draw the landscape</span>
                        <span class="comment">\ behind the object</span>

 <span class="mne">STA</span> <a class="popup variable">doNotDitherObject</a>  <span class="comment">\ Clear bit 7 of doNotDitherObject to enable objects to</span>
                        <span class="comment">\ be updated on the screen with a dithered effect</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>

<span class="label">.DrawUpdatedObject</span><a id="drawupdatedobject" class="anchor"></a>

 <span class="mne">JSR</span> <a class="popup destination">GetObjVisibility</a>   <span class="comment">\ Calculate whether any part of the current object is</span>
                        <span class="comment">\ visible on-screen and set the C flag as follows:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Clear = at least some of the object is visible</span>
                        <span class="comment">\             on-screen</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * Set = the object is not visible on-screen</span>
                        <span class="comment">\</span>
                        <span class="comment">\ If the object is visible, also set the following:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * bufferColumns = the number of character columns</span>
                        <span class="comment">\     in the screen buffer that the object spans (capped</span>
                        <span class="comment">\     to a maximum value of 20)</span>
                        <span class="comment">\</span>
                        <span class="comment">\   * objYawOffset = the yaw offset of the left edge of</span>
                        <span class="comment">\     the object from the left edge of the screen, in</span>
                        <span class="comment">\     character columns</span>

 <span class="mne">BCS</span> <a class="popup destination">updo1</a>              <span class="comment">\ If the C flag is set then the object is not visible</span>
                        <span class="comment">\ on-screen, so jump to updo1 to reset the various</span>
                        <span class="comment">\ dither-related variables and return from the</span>
                        <span class="comment">\ subroutine as there is nothing to update on the screen</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">25</span>                <span class="comment">\ Set ditherOuterLoop = 25, so the dithered effect in</span>
 <span class="mne">STA</span> <a class="popup variable">ditherOuterLoop</a>    <span class="comment">\ the DitherScreenBuffer routine implements 25 outer</span>
                        <span class="comment">\ loops, where each inner loop dithers 255 pixels to the</span>
                        <span class="comment">\ screen</span>

 <span class="mne">LDA</span> <a class="popup variable">ditherObjectSights</a> <span class="comment">\ If bit 7 of ditherObjectSights is clear then we are</span>
 <span class="mne">BPL</span> <a class="popup destination">updo2</a>              <span class="comment">\ not configured to remove the sights before updating</span>
                        <span class="comment">\ the object on-screen, so jump to updo2 to skip the</span>
                        <span class="comment">\ following</span>

 <span class="mne">SEI</span>                    <span class="comment">\ Disable interrupts to ensure that the screen doesn't</span>
                        <span class="comment">\ scroll while we are removing the sights, as that could</span>
                        <span class="comment">\ corrupt the screen</span>

 <span class="mne">JSR</span> <a class="popup destination">RemoveSights</a>       <span class="comment">\ Bit 7 of ditherObjectSights is set, so we need to</span>
                        <span class="comment">\ remove the sights from the screen before we update the</span>
                        <span class="comment">\ object on-screen, so call the RemoveSights routine</span>

 <span class="mne">CLI</span>                    <span class="comment">\ Re-enable interrupts</span>

<span class="label">.updo2</span><a id="updo2" class="anchor"></a>

 <span class="mne">LDX</span> <a class="popup variable">viewingObject</a>      <span class="comment">\ Set X to the viewing object</span>

 <span class="mne">LDA</span> <a class="popup variable">objYawOffset</a>       <span class="comment">\ Set yawAdjustment(Hi Lo) = (objYawOffset 0) / 2</span>
 <span class="mne">STA</span> <a class="popup variable">yawAdjustmentHi</a>    <span class="comment">\</span>
 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ This converts the yaw offset in objYawOffset from</span>
 <span class="mne">LSR</span> <a class="popup variable">yawAdjustmentHi</a>    <span class="comment">\ character columns into a yaw angle and stores the</span>
 <span class="mne">ROR</span> <span class="register">A</span>                  <span class="comment">\ result in yawAdjustment(Hi Lo)</span>
 <span class="mne">STA</span> <a class="popup variable">yawAdjustmentLo</a>    <span class="comment">\</span>
                        <span class="comment">\ The custom screen mode 5 used by the game is 40</span>
                        <span class="comment">\ character columns wide, and the screen is 20 yaw</span>
                        <span class="comment">\ angles wide in terms of the game's coordinate system</span>
                        <span class="comment">\</span>
                        <span class="comment">\ So we can simply halve the character column count in</span>
                        <span class="comment">\ objYawOffset to convert it into a yaw angle</span>

 <span class="mne">LDA</span> <a class="popup variable">yawAdjustmentHi</a>    <span class="comment">\ Add yawAdjustmentHi to the yaw angle for the viewing</span>
 <span class="mne">ADC</span> <a class="popup variable">objectYawAngle</a>,<span class="register">X</span>   <span class="comment">\ object, so the viewing object is now looking directly</span>
 <span class="mne">STA</span> <a class="popup variable">objectYawAngle</a>,<span class="register">X</span>   <span class="comment">\ at the left edge of the object, so when we draw the</span>
                        <span class="comment">\ object, we will draw it into the screen buffer with</span>
                        <span class="comment">\ the object aligned with the left edge of the buffer</span>
                        <span class="comment">\</span>
                        <span class="comment">\ The addition works because the ROR instruction clears</span>
                        <span class="comment">\ the C flag, as A is zero before the rotation</span>

 <span class="mne">LDY</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Zero lastPanKeyPressed so that when we draw the screen</span>
 <span class="mne">STY</span> <a class="popup variable">lastPanKeyPressed</a>  <span class="comment">\ buffer onto the screen below, we draw the buffer onto</span>
                        <span class="comment">\ the screen in columns, working from left to right, in</span>
                        <span class="comment">\ the same way as for a pan to the right (which is what</span>
                        <span class="comment">\ a zero value of lastPanKeyPressed usually represents)</span>

 <span class="mne">LDA</span> <a class="popup variable">bufferColumns</a>      <span class="comment">\ Set up the screen buffer so it will hold an object</span>
 <span class="mne">JSR</span> <a class="popup destination">ConfigureObjBuffer</a> <span class="comment">\ with the number of character columns that the object</span>
                        <span class="comment">\ spans, as calculated by the call to GetObjVisibility</span>
                        <span class="comment">\ above</span>
                        <span class="comment">\</span>
                        <span class="comment">\ The object might be too wide to fit into the screen</span>
                        <span class="comment">\ buffer (as we configure it as a column buffer to make</span>
                        <span class="comment">\ sure the entire visible part of the object fits into</span>
                        <span class="comment">\ the buffer height-wise), but this ensures that the</span>
                        <span class="comment">\ buffer contains as much of the visible part of the</span>
                        <span class="comment">\ object as possible</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">25</span>                <span class="comment">\ Set A = 25 to pass to FillScreen, so we fill the</span>
                        <span class="comment">\ screen buffer (as opposed to screen memory)</span>

 <span class="mne">LDY</span> <span class="hash">#</span><span class="decimal">24</span>                <span class="comment">\ Set Y = 24 to pass to FillScreen, so we fill 24</span>
                        <span class="comment">\ character rows of the screen buffer</span>

 <span class="mne">LDX</span> <a class="popup variable">bufferColumns</a>      <span class="comment">\ Set X = bufferColumns to pass to FillScreen, so we</span>
                        <span class="comment">\ fill bufferColumns character columns in the screen</span>
                        <span class="comment">\ buffer</span>

 <span class="mne">JSR</span> <a class="popup destination">FillScreen</a>         <span class="comment">\ Call FillScreen to fill the screen buffer with the</span>
                        <span class="comment">\ background specified in screenBackground</span>
                        <span class="comment">\</span>
                        <span class="comment">\ If we are updating an object as part of the gameplay,</span>
                        <span class="comment">\ then screenBackground variable will have been zeroed</span>
                        <span class="comment">\ in DrawTitleView before the gameplay starts, so this</span>
                        <span class="comment">\ call to FillScreen will fill the buffer with</span>
                        <span class="comment">\ alternating colour 0/1 (blue/black) pixel rows, for</span>
                        <span class="comment">\ the sky</span>
                        <span class="comment">\</span>
                        <span class="comment">\ If we are drawing an object on the game over screen</span>
                        <span class="comment">\ then screenBackground will be 3 and the background</span>
                        <span class="comment">\ will be a black screen with stars</span>

 <span class="mne">BIT</span> <a class="popup variable">drawLandscape</a>      <span class="comment">\ If bit 7 of drawLandscape is clear then we need to</span>
 <span class="mne">BPL</span> <a class="popup destination">updo3</a>              <span class="comment">\ draw both the object and the surrounding landscape, so</span>
                        <span class="comment">\ jump to updo3 to do this</span>

                        <span class="comment">\ If bit 7 of drawLandscape is set then we are showing</span>
                        <span class="comment">\ the game over screen, so we just need to draw the</span>
                        <span class="comment">\ object on its own and without the surrounding</span>
                        <span class="comment">\ landscape</span>

 <span class="mne">LDY</span> <a class="popup variable">currentObject</a>      <span class="comment">\ Draw the current object into the screen buffer</span>
 <span class="mne">JSR</span> <a class="popup destination">DrawObject</a>

 <span class="mne">JMP</span> <a class="popup destination">updo4</a>              <span class="comment">\ Jump to updo4 to skip the following instruction and</span>
                        <span class="comment">\ move on to updating the screen</span>

<span class="label">.updo3</span><a id="updo3" class="anchor"></a>

 <span class="mne">JSR</span> <a class="popup destination">DrawLandscapeView</a>  <span class="comment">\ Draw the object into the screen buffer, as part of the</span>
                        <span class="comment">\ landscape view</span>

<span class="label">.updo4</span><a id="updo4" class="anchor"></a>

                        <span class="comment">\ By this point we have drawn the updated object into</span>
                        <span class="comment">\ the screen buffer, so we now need to copy the results</span>
                        <span class="comment">\ onto the screen</span>

 <span class="mne">LDY</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Set screenBufferAddr(1 0) to the address of the left</span>
 <span class="mne">JSR</span> <a class="popup destination">SetBufferAddress</a>   <span class="comment">\ column of the screen buffer</span>

 <span class="mne">LDX</span> <a class="popup variable">viewingObject</a>      <span class="comment">\ Set X to the viewing object</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Set yawAdjustmentLo = 0 so when we draw the landscape</span>
 <span class="mne">STA</span> <a class="popup variable">yawAdjustmentLo</a>    <span class="comment">\ again, it doesn't include the yaw adjustment for</span>
                        <span class="comment">\ drawing this object</span>

 <span class="mne">SEC</span>                    <span class="comment">\ Subtract yawAdjustmentHi from the yaw angle for the</span>
 <span class="mne">LDA</span> <a class="popup variable">objectYawAngle</a>,<span class="register">X</span>   <span class="comment">\ viewing, so the reverses the addition that we did</span>
 <span class="mne">SBC</span> <a class="popup variable">yawAdjustmentHi</a>    <span class="comment">\ above so the yaw angle of the viewing object is back</span>
 <span class="mne">STA</span> <a class="popup variable">objectYawAngle</a>,<span class="register">X</span>   <span class="comment">\ to the value it has for the normal landscape view</span>

                        <span class="comment">\ We now calculate the screen address of the left edge</span>
                        <span class="comment">\ of the object in the landscape view, as that's where</span>
                        <span class="comment">\ we want to copy the contents of the screen buffer</span>
                        <span class="comment">\</span>
                        <span class="comment">\ The landscape view is at viewScreenAddr(1 0) in screen</span>
                        <span class="comment">\ memory, and the number of character columns between</span>
                        <span class="comment">\ the left edge of the screen and the left edge of the</span>
                        <span class="comment">\ object is in objYawOffset, so now we convert the</span>
                        <span class="comment">\ character columns into screen memory bytes and add</span>
                        <span class="comment">\ that to viewScreenAddr(1 0), and that gives us the</span>
                        <span class="comment">\ address in screen memory of the top-left corner of the</span>
                        <span class="comment">\ object's position on-screen</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Set (U A) = objYawOffset</span>
 <span class="mne">STA</span> <a class="popup variable">U</a>
 <span class="mne">LDA</span> <a class="popup variable">objYawOffset</a>

 <span class="mne">ASL</span> <span class="register">A</span>                  <span class="comment">\ Set (U A) = (U A) * 8</span>
 <span class="mne">ASL</span> <span class="register">A</span>                  <span class="comment">\           = objYawOffset * 8</span>
 <span class="mne">ASL</span> <span class="register">A</span>                  <span class="comment">\</span>
 <span class="mne">ROL</span> <a class="popup variable">U</a>                  <span class="comment">\ This converts the yaw offset in objYawOffset from</span>
                        <span class="comment">\ character columns into pixel bytes and stores the</span>
                        <span class="comment">\ result in (U A), as each character block contains</span>
                        <span class="comment">\ eight bytes</span>
                        <span class="comment">\</span>
                        <span class="comment">\ We don't have to ROL the first two shifts into U as</span>
                        <span class="comment">\ we know objYawOffset is less than 40, so the first two</span>
                        <span class="comment">\ ASLs will only ever shift zeroes into the C flag</span>

 <span class="mne">CLC</span>                    <span class="comment">\ Set (A objScreenAddr) = viewScreenAddr(1 0) + (U A)</span>
 <span class="mne">ADC</span> <a class="popup variable">viewScreenAddr</a>
 <span class="mne">STA</span> <a class="popup variable">objScreenAddr</a>
 <span class="mne">LDA</span> <a class="popup variable">viewScreenAddr</a><span class="operator">+</span><span class="decimal">1</span>
 <span class="mne">ADC</span> <a class="popup variable">U</a>

 <span class="mne">CMP</span> <span class="hash">#</span><span class="hex">&80</span>               <span class="comment">\ If the high byte in A >= &80 then the new address is</span>
 <span class="mne">BCC</span> <a class="popup destination">updo5</a>              <span class="comment">\ past the end of screen memory, so subtract &20 from</span>
 <span class="mne">SBC</span> <span class="hash">#</span><span class="hex">&20</span>               <span class="comment">\ the high byte so the address wraps around within the</span>
                        <span class="comment">\ range of screen memory between &6000 and &8000</span>

<span class="label">.updo5</span><a id="updo5" class="anchor"></a>

 <span class="mne">STA</span> <a class="popup variable">objScreenAddr</a><span class="operator">+</span><span class="decimal">1</span>    <span class="comment">\ Store the high byte of the result, so we now have:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   objScreenAddr(1 0) = viewScreenAddr(1 0) + (U A)</span>
                        <span class="comment">\</span>
                        <span class="comment">\ with the address wrapped around as required</span>
                        <span class="comment">\</span>
                        <span class="comment">\ So this gives us the address in screen memory of the</span>
                        <span class="comment">\ top-left corner of the object's position on-screen</span>

 <span class="mne">BIT</span> <a class="popup variable">ditherObjectSights</a> <span class="comment">\ If bit 6 of ditherObjectSights is clear then we do not</span>
 <span class="mne">BVC</span> <a class="popup destination">updo7</a>              <span class="comment">\ draw the object on-screen with a dithered effect, so</span>
                        <span class="comment">\ jump to updo7 to skip the following and move straight</span>
                        <span class="comment">\ on to drawing the whole object to the screen</span>

 <span class="mne">BIT</span> <a class="popup variable">sentinelHasWon</a>     <span class="comment">\ If bit 7 of sentinelHasWon is clear then the Sentinel</span>
 <span class="mne">BPL</span> <a class="popup destination">updo6</a>              <span class="comment">\ has not won the game, so skip the following to leave</span>
                        <span class="comment">\ ditherOuterLoop set to 25, which is the correct amount</span>
                        <span class="comment">\ of time to spend dithering when updating objects on</span>
                        <span class="comment">\ landscape during gameplay</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">40</span>                <span class="comment">\ The Sentinel has won and we are therefore drawing the</span>
 <span class="mne">STA</span> <a class="popup variable">ditherOuterLoop</a>    <span class="comment">\ game over screen rather than updating an object in the</span>
                        <span class="comment">\ landscape, so set ditherOuterLoop = 40 to make the</span>
                        <span class="comment">\ dithered effect in the DitherScreenBuffer routine last</span>
                        <span class="comment">\ for 40 outer loops rather than 25, where each inner</span>
                        <span class="comment">\ loop dithers 255 pixels to the screen</span>

<span class="label">.updo6</span><a id="updo6" class="anchor"></a>

 <span class="mne">JSR</span> <a class="popup destination">DitherScreenBuffer</a> <span class="comment">\ Dither the contents of the screen buffer onto the</span>
                        <span class="comment">\ screen</span>
                        <span class="comment">\</span>
                        <span class="comment">\ Note that this process does not update the entire</span>
                        <span class="comment">\ object on-screen, so we will need to do that at updo7</span>
                        <span class="comment">\ below once we have finished dithering</span>

 <span class="mne">LDA</span> <a class="popup variable">sentinelHasWon</a>     <span class="comment">\ If bit 7 of sentinelHasWon is set then the Sentinel</span>
 <span class="mne">BMI</span> <a class="popup destination">updo11</a>             <span class="comment">\ has won the game and we are therefore drawing the game</span>
                        <span class="comment">\ over screen and we don't want to draw the victorious</span>
                        <span class="comment">\ enemy completely, so jump to updo11 to skip the part</span>
                        <span class="comment">\ where the object is fully drawn on-screen</span>

<span class="label">.updo7</span><a id="updo7" class="anchor"></a>

                        <span class="comment">\ By this point we have either finished dithering the</span>
                        <span class="comment">\ updated object onto the screen (if dithering was</span>
                        <span class="comment">\ configured), or dithering was not configured</span>
                        <span class="comment">\</span>
                        <span class="comment">\ In either case we now need to draw the whole object</span>
                        <span class="comment">\ onto the screen</span>

 <span class="mne">SEI</span>                    <span class="comment">\ Disable interrupts to ensure that the screen doesn't</span>
                        <span class="comment">\ scroll while we are removing the sights, as that could</span>
                        <span class="comment">\ corrupt the screen</span>

 <span class="mne">JSR</span> <a class="popup destination">RemoveSights</a>       <span class="comment">\ Remove the sights from the screen before we update the</span>
                        <span class="comment">\ object on-screen by calling the RemoveSights routine</span>

 <span class="mne">SEC</span>                    <span class="comment">\ Set bit 7 of doNotDrawSights so the DrawSights routine</span>
 <span class="mne">ROR</span> <a class="popup variable">doNotDrawSights</a>    <span class="comment">\ does not draw the sights on-screen going forward</span>
                        <span class="comment">\</span>
                        <span class="comment">\ This prevents the interrupt handler from drawing the</span>
                        <span class="comment">\ sights, in case it starts processing a sights-related</span>
                        <span class="comment">\ key press while we still are doing the updating</span>

 <span class="mne">CLI</span>                    <span class="comment">\ Re-enable interrupts</span>

 <span class="mne">LDA</span> <a class="popup variable">objScreenAddr</a>      <span class="comment">\ Set toAddr(1 0) to the address of the object in screen</span>
 <span class="mne">STA</span> <a class="popup variable">toAddr</a>             <span class="comment">\ memory which we put into objScreenAddr(1 0) above, so</span>
 <span class="mne">LDA</span> <a class="popup variable">objScreenAddr</a><span class="operator">+</span><span class="decimal">1</span>    <span class="comment">\ we copy the screen contents from the screen buffer to</span>
 <span class="mne">STA</span> <a class="popup variable">toAddr</a><span class="operator">+</span><span class="decimal">1</span>           <span class="comment">\ the correct place on-screen</span>

 <span class="mne">LDA</span> <a class="popup variable">bufferColumns</a>      <span class="comment">\ We are now going to loop through the character columns</span>
 <span class="mne">STA</span> <a class="popup variable">loopCounter</a>        <span class="comment">\ that we want to copy to the screen, so set a loop</span>
                        <span class="comment">\ counter to the number of columns in bufferColumns,</span>
                        <span class="comment">\ which we set to the column count for covering the</span>
                        <span class="comment">\ whole object (or as many as we can fit into the column</span>
                        <span class="comment">\ buffer, at least)</span>

 <span class="mne">JMP</span> <a class="popup destination">updo10</a>             <span class="comment">\ We are now ready to copy the configured number of</span>
                        <span class="comment">\ character columns from the screen buffer to the</span>
                        <span class="comment">\ screen, so jump into the following loop at updo10</span>

<span class="label">.updo8</span><a id="updo8" class="anchor"></a>

                        <span class="comment">\ We have updated an on-screen character column, so now</span>
                        <span class="comment">\ we move to the next character column to the right</span>

 <span class="mne">LDA</span> <a class="popup variable">objScreenAddr</a>      <span class="comment">\ Set (A objScreenAddr) = objScreenAddr(1 0) + 8</span>
 <span class="mne">CLC</span>                    <span class="comment">\</span>
 <span class="mne">ADC</span> <span class="hash">#</span><span class="decimal">8</span>                 <span class="comment">\ and (A toAddr) = objScreenAddr(1 0) + 8</span>
 <span class="mne">STA</span> <a class="popup variable">objScreenAddr</a>      <span class="comment">\</span>
 <span class="mne">STA</span> <a class="popup variable">toAddr</a>             <span class="comment">\ So this moves both the from and to addresses to the</span>
 <span class="mne">LDA</span> <a class="popup variable">objScreenAddr</a><span class="operator">+</span><span class="decimal">1</span>    <span class="comment">\ next character column along</span>
 <span class="mne">ADC</span> <span class="hash">#</span><span class="decimal">0</span>

 <span class="mne">CMP</span> <span class="hash">#</span><span class="hex">&80</span>               <span class="comment">\ If the high byte in A >= &80 then the new address is</span>
 <span class="mne">BCC</span> <a class="popup destination">updo9</a>              <span class="comment">\ past the end of screen memory, so subtract &20 from</span>
 <span class="mne">SBC</span> <span class="hash">#</span><span class="hex">&20</span>               <span class="comment">\ the high byte so the address wraps around within the</span>
                        <span class="comment">\ range of screen memory between &6000 and &8000</span>

<span class="label">.updo9</span><a id="updo9" class="anchor"></a>

 <span class="mne">STA</span> <a class="popup variable">objScreenAddr</a><span class="operator">+</span><span class="decimal">1</span>    <span class="comment">\ Store the high byte of the result, so we now have:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   objScreenAddr(1 0) = objScreenAddr(1 0) + 8</span>
                        <span class="comment">\</span>
                        <span class="comment">\ with the address wrapped around as required</span>

 <span class="mne">STA</span> <a class="popup variable">toAddr</a><span class="operator">+</span><span class="decimal">1</span>           <span class="comment">\ Store the high byte of the result, so we now have:</span>
                        <span class="comment">\</span>
                        <span class="comment">\   toAddr(1 0) = toAddr(1 0) + 8</span>
                        <span class="comment">\</span>
                        <span class="comment">\ with the address wrapped around as required</span>

<span class="label">.updo10</span><a id="updo10" class="anchor"></a>

                        <span class="comment">\ This is where we enter the screen-updating loop</span>

 <span class="mne">LDY</span> <a class="popup variable">lastPanKeyPressed</a>  <span class="comment">\ Set Y to the value of lastPanKeyPressed, which we set</span>
                        <span class="comment">\ to zero above</span>
                        <span class="comment">\</span>
                        <span class="comment">\ Zero is normally the value for when we are panning the</span>
                        <span class="comment">\ screen to the right, but we use it here because when</span>
                        <span class="comment">\ we pan to the right, we draw the screen buffer onto</span>
                        <span class="comment">\ the screen in columns, working from left to right, and</span>
                        <span class="comment">\ that's also what we want to do when updating the</span>
                        <span class="comment">\ object</span>

 <span class="mne">JSR</span> <a class="popup destination">ShowScreenBuffer</a>   <span class="comment">\ Update the player's scrolling landscape view by</span>
                        <span class="comment">\ copying the relevant parts of the screen buffer into</span>
                        <span class="comment">\ screen memory</span>

 <span class="mne">DEC</span> <a class="popup variable">loopCounter</a>        <span class="comment">\ Decrement the loop counter to move on to the next</span>
                        <span class="comment">\ character column in the updated object</span>

 <span class="mne">BNE</span> <a class="popup destination">updo8</a>              <span class="comment">\ Loop back to keep drawing character columns from the</span>
                        <span class="comment">\ screen buffer until we have drawn them all</span>

<span class="label">.updo11</span><a id="updo11" class="anchor"></a>

                        <span class="comment">\ We now need to check whether we have updated the whole</span>
                        <span class="comment">\ object on-screen</span>
                        <span class="comment">\</span>
                        <span class="comment">\ The column buffer is 24 character rows tall and up to</span>
                        <span class="comment">\ 20 character columns wide, so if the on-screen object</span>
                        <span class="comment">\ wider than 20 character columns (i.e. wider than half</span>
                        <span class="comment">\ a screen width), then we can't fit the whole object</span>
                        <span class="comment">\ into the column buffer in one go, so we need to draw</span>
                        <span class="comment">\ it in two stages</span>

 <span class="mne">LDA</span> <a class="popup variable">objYawOffset</a>       <span class="comment">\ Set objYawOffset = objYawOffset + bufferColumns</span>
 <span class="mne">CLC</span>                    <span class="comment">\</span>
 <span class="mne">ADC</span> <a class="popup variable">bufferColumns</a>      <span class="comment">\ This sets the yaw offset to the character column to</span>
 <span class="mne">STA</span> <a class="popup variable">objYawOffset</a>       <span class="comment">\ the right of the on-screen block that we just drew</span>
                        <span class="comment">\ to update the object</span>

 <span class="mne">LDA</span> <a class="popup variable">objYawWidth</a>        <span class="comment">\ Set A = objYawWidth - bufferColumns</span>
 <span class="mne">SEC</span>                    <span class="comment">\</span>
 <span class="mne">SBC</span> <a class="popup variable">bufferColumns</a>      <span class="comment">\ We just drew bufferColumns character columns of the</span>
                        <span class="comment">\ object and objYawWidth contains the full width of the</span>
                        <span class="comment">\ on-screen object in character columns, so A now</span>
                        <span class="comment">\ contains the number of character columns that we still</span>
                        <span class="comment">\ have to draw</span>

 <span class="mne">BEQ</span> <a class="popup destination">updo12</a>             <span class="comment">\ If A = 0 then we have drawn the whole object, so jump</span>
                        <span class="comment">\ to updo12 to finish off</span>

                        <span class="comment">\ If we get here then A is non-zero so we still have</span>
                        <span class="comment">\ more of the object to update on-screen, so we update</span>
                        <span class="comment">\ the variables and loop back to draw the next set of</span>
                        <span class="comment">\ 20 character columns to the right, dithering them in</span>
                        <span class="comment">\ the same way if required</span>

 <span class="mne">STA</span> <a class="popup variable">objYawWidth</a>        <span class="comment">\ Set the width of the on-screen object to A so it</span>
                        <span class="comment">\ contains the number of character columns we still have</span>
                        <span class="comment">\ to draw</span>

 <span class="mne">STA</span> <a class="popup variable">bufferColumns</a>      <span class="comment">\ Configure the buffer width to the correct size for the</span>
                        <span class="comment">\ second batch of character columns</span>

 <span class="mne">STA</span> <a class="popup variable">ditherOuterLoop</a>    <span class="comment">\ Set ditherOuterLoop to A, so the dithered effect in</span>
                        <span class="comment">\ the DitherScreenBuffer routine implements A outer</span>
                        <span class="comment">\ loops, where each inner loop dithers 255 pixels to the</span>
                        <span class="comment">\ screen</span>

 <span class="mne">JMP</span> <a class="popup destination">updo2</a>              <span class="comment">\ Jump back to updo2 to update the second part of the</span>
                        <span class="comment">\ on-screen object</span>

<span class="label">.updo12</span><a id="updo12" class="anchor"></a>

 <span class="mne">LSR</span> <a class="popup variable">doNotDrawSights</a>    <span class="comment">\ Clear bit 7 of doNotDrawSights so the DrawSights</span>
                        <span class="comment">\ routine is enabled once again</span>

 <span class="mne">LDA</span> <a class="popup variable">sightsAreVisible</a>   <span class="comment">\ If bit 7 of sightsAreVisible is clear then the sights</span>
 <span class="mne">BPL</span> <a class="popup destination">updo13</a>             <span class="comment">\ are not currently being shown on-screen, so jump to</span>
                        <span class="comment">\ updo13 to skip the following</span>

 <span class="mne">SEI</span>                    <span class="comment">\ Disable interrupts to ensure that the screen doesn't</span>
                        <span class="comment">\ scroll while we are drawing the sights, as that could</span>
                        <span class="comment">\ corrupt the screen</span>

 <span class="mne">JSR</span> <a class="popup destination">DrawSights</a>         <span class="comment">\ Bit 7 of sightsAreVisible is set, so we need to draw</span>
                        <span class="comment">\ the sights that we removed when updating the object,</span>
                        <span class="comment">\ so call DrawSights to put them back</span>

 <span class="mne">CLI</span>                    <span class="comment">\ Re-enable interrupts</span>

<span class="label">.updo13</span><a id="updo13" class="anchor"></a>

 <span class="mne">JMP</span> <a class="popup destination">updo1</a>              <span class="comment">\ We have finished updating the object, so jump to updo1</span>
                        <span class="comment">\ to reset the various dither-related variables and</span>
                        <span class="comment">\ return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-configureobjbuffer"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/configureobjbuffer.html">ConfigureObjBuffer</a> (category: Screen buffer)</div><div class="summary">Set up the variables required to configure the screen buffer for updating an object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ditherscreenbuffer"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/ditherscreenbuffer.html">DitherScreenBuffer</a> (category: Screen buffer)</div><div class="summary">Dither the contents of the screen buffer onto the screen</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawlandscapeview"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/drawlandscapeview_part_1_of_3.html">DrawLandscapeView (Part 1 of 3)</a> (category: Drawing the landscape)</div><div class="summary">Set up a number of variables for drawing the landscape view</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawobject"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/drawobject.html">DrawObject</a> (category: Drawing objects)</div><div class="summary">Draw a 3D object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawsights"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/drawsights.html">DrawSights</a> (category: Sights)</div><div class="summary">Draw the sights on the screen, saving the existing screen contents in the sights pixel byte stash</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-fillscreen"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/fillscreen.html">FillScreen</a> (category: Graphics)</div><div class="summary">Fill a rectangular in screen memory or the screen buffer with the specified background</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-getobjvisibility"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/getobjvisibility.html">GetObjVisibility</a> (category: Gameplay)</div><div class="summary">Calculate whether any part of an object is visible on-screen, and if so, which character columns it spans on the screen</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-removesights"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/removesights.html">RemoveSights</a> (category: Sights)</div><div class="summary">Remove the sights from the screen</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-setbufferaddress"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/setbufferaddress.html">SetBufferAddress</a> (category: Screen buffer)</div><div class="summary">Set screenBufferAddr(1 0) to the address from which the interrupt handler should fetch new content to scroll onto the screen</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-showscreenbuffer"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/showscreenbuffer.html">ShowScreenBuffer</a> (category: Screen buffer)</div><div class="summary">Update the player's scrolling landscape view by copying the relevant parts of the screen buffer into screen memory</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-u"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#u">U</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">Temporary storage, used in a number of places</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-buffercolumns"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#buffercolumns">bufferColumns</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The number of character columns in the current screen buffer</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-currentobject"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#currentobject">currentObject</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The number of the object we are currently processing</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ditherobjectsights"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#ditherobjectsights">ditherObjectSights</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Configures how an updated object is drawn onto the screen in the DrawUpdatedObject routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-ditherouterloop"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/ditherouterloop.html">ditherOuterLoop</a> (category: Screen buffer)</div><div class="summary">A counter for the inner loop when dithering objects to the screen in the DitherScreenBuffer routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-donotditherobject"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#donotditherobject">doNotDitherObject</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Controls whether the DitherScreenBuffer routine can update an object on the screen using a dithered effect</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-donotdrawsights"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#donotdrawsights">doNotDrawSights</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag that controls whether we draw the sights in the DrawSights routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-drawlandscape"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#drawlandscape">drawLandscape</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Configures whether to draw the landscape behind the object in the DrawUpdatedObject routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-lastpankeypressed"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#lastpankeypressed">lastPanKeyPressed</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The direction of the last pan key that was pressed (which may not still be held down)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-loopcounter"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#loopcounter">loopCounter</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">A general-purpose loop counter</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objscreenaddr"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/objscreenaddr.html">objScreenAddr</a> (category: Screen buffer)</div><div class="summary">The screen address of the object we are updating</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objyawoffset"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#objyawoffset">objYawOffset</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The yaw offset of the left edge of the object being analysed in GetObjVisibility, relative to the left edge of the screen, in on-screen character columns</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objyawwidth"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#objyawwidth">objYawWidth</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The width of the visible portion of the object being analysed in GetObjVisibility, in on-screen character columns</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-objectyawangle"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/objectyawangle.html">objectYawAngle</a> (category: 3D objects)</div><div class="summary">The yaw angle for each object (i.e. the horizontal direction in which they are facing)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-sentinelhaswon"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#sentinelhaswon">sentinelHasWon</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">A flag to record when the player runs out of energy (i.e. the energy level goes negative), at which point the Sentinel wins</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-sightsarevisible"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#sightsarevisible">sightsAreVisible</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Controls whether the sights are being shown</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-toaddr"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#toaddr">toAddr</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">An address, typically used as a destination address when copying</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo1"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo1">updo1</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo10"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo10">updo10</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo11"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo11">updo11</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo12"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo12">updo12</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo13"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo13">updo13</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo2"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo2">updo2</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo3"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo3">updo3</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo4"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo4">updo4</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo5"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo5">updo5</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo6"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo6">updo6</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo7"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo7">updo7</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo8"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo8">updo8</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-updo9"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Label <a href="/source/main/subroutine/drawupdatedobject.html#updo9">updo9</a> is local to this routine</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-viewscreenaddr"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#viewscreenaddr">viewScreenAddr</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">The screen address of the player's scrolling landscape view, which is just below the icon and scanner row at the top of the screen</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-viewingobject"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#viewingobject">viewingObject</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The number of the viewing object</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-yawadjustmenthi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/yawadjustmenthi.html">yawAdjustmentHi</a> (category: Screen buffer)</div><div class="summary">The yaw offset of the left edge of the object being updated, relative to the left edge of the screen, in yaw angles</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-yawadjustmentlo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#yawadjustmentlo">yawAdjustmentLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">A yaw adjustment to apply to the landscape drawing process so that when we update objects on-screen, we can yaw the viewer's gaze to the right to move the left edge of the object to the left edge of the screen so the object will fit into the screen buffer as efficiently as possible (low byte)</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/variable/tilenumber.html">tileNumber</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/screenbufferaddr.html">screenBufferAddr</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
