<?php
include_once("../../../templates/template_functions.php");
page_header("main_game_loop", "subroutine_playgame.html", "The PlayGame subroutine", "Main game loop: PlayGame", "Annotated code for the PlayGame subroutine in The Sentinel", "the_sentinel-code", "source_main_game_loop", "subroutine_playgame", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/processsound.html">ProcessSound</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/maingameloop.html">MainGameLoop</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">PlayGame</span>                                                <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Main game loop</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Start playing the generated landscape</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_g.html#header-playgame">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/checksecretcode_part_2_of_2.html">CheckSecretCode (Part 2 of 2)</a> calls <a href="#playgame">PlayGame</a></span>
</div>
</div></div>
<span class="label">.PlayGame</span><a id="playgame" class="anchor"></a>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="hex">&83</span>               <span class="comment">\ Set the palette to the first set of colours from the</span>
 <span class="mne">JSR</span> <a class="popup destination">SetColourPalette</a>   <span class="comment">\ colourPalettes table, which the SpawnEnemies routine</span>
                        <span class="comment">\ set to the correct palette for playing the game (so</span>
                        <span class="comment">\ for landscape 0000 that would be blue, black, white</span>
                        <span class="comment">\ and green, for example)</span>
                        <span class="comment">\</span>
                        <span class="comment">\ So this displays the landscape preview screen that we</span>
                        <span class="comment">\ drew in PreviewLandscape with an all-blue palette</span>
                        <span class="comment">\ before jumping here</span>

 <span class="mne">JSR</span> <a class="popup destination">ReadKeyboard</a>       <span class="comment">\ Enable the keyboard, flush the keyboard buffer and</span>
                        <span class="comment">\ read a character from it (so this waits for a key</span>
                        <span class="comment">\ press before starting the game, following the "PRESS</span>
                        <span class="comment">\ ANY KEY" message on the landscape preview screen)</span>

 <span class="mne">LSR</span> <a class="popup variable">gameInProgress</a>     <span class="comment">\ Clear bit 7 of gameInProgress to indicate that a game</span>
                        <span class="comment">\ now in progress and we are no longer in the title and</span>
                        <span class="comment">\ preview screens (so the interrupt handler can now</span>
                        <span class="comment">\ update the game)</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-readkeyboard"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/readkeyboard.html">ReadKeyboard</a> (category: Keyboard)</div><div class="summary">Enable the keyboard and read a character from it</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-setcolourpalette"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Subroutine <a href="/source/main/subroutine/setcolourpalette.html">SetColourPalette</a> (category: Graphics)</div><div class="summary">Set the logical colours for each of the four physical colours in screen mode 5</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-gameinprogress"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/main_variable_workspace.html#gameinprogress">gameInProgress</a> in workspace <a href="/source/main/workspace/main_variable_workspace.html">Main variable workspace</a></div><div class="summary">Flags whether or not a game is in progress (i.e. the player is playing a landscape rather than interacting with the title and preview screens)</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/processsound.html">ProcessSound</a><a class="next" rel="next" title="Next routine" href="/source/main/subroutine/maingameloop.html">MainGameLoop</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
