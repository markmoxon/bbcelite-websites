<?php
include_once("../../../templates/template_functions.php");
page_header("screen_buffer", "subroutine_configurebuffer.html", "The ConfigureBuffer subroutine", "Screen buffer: ConfigureBuffer", "Annotated code for the ConfigureBuffer subroutine in The Sentinel", "the_sentinel-code", "source_screen_buffer", "subroutine_configurebuffer", "");
?>
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/flipbuffertype.html">FlipBufferType</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/buffersorigin.html">buffersOrigin</a></nav>
				</div>

				<div class="codeBlockWrapper">
<pre class="codeBlock sourceCode initial"><div class="headerBlockWrapper"><div class="headerBlock"><span class="headerLabel">       Name:</span> <span class="headerEntry">ConfigureBuffer</span>                                         <span class="routineLink">[<a class="extraDataLink" href="#">Show more</a>]</span>
<span class="headerLabel">       Type:</span> <span class="headerEntry">Subroutine</span>
<span class="headerLabel">   Category:</span> <span class="headerEntry">Screen buffer</span>
<span class="headerLabel">    Summary:</span> <span class="headerEntry">Set up the variables required to configure the screen buffer to a</span>
             <span class="headerEntry">specific buffer type</span>
<div class="extraData"><span class="headerLabel">    Context:</span> <span class="headerEntry">See this subroutine <a href="/source/all/the_sentinel_e.html#header-configurebuffer">in context in the source code</a></span>
<span class="headerLabel"> References:</span> <span class="headerEntry">This subroutine is called as follows:</span>
             <span class="headerEntry">* <a href="/source/main/subroutine/clearscreen.html">ClearScreen</a> calls <a href="#configurebuffer">ConfigureBuffer</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/maingameloop.html">MainGameLoop</a> calls <a href="#configurebuffer">ConfigureBuffer</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/usecolumnbuffer.html">UseColumnBuffer</a> calls <a href="#configurebuffer">ConfigureBuffer</a></span>
             <span class="headerEntry">* <a href="/source/main/subroutine/userowbuffer.html">UseRowBuffer</a> calls <a href="#configurebuffer">ConfigureBuffer</a></span>
</div>
<hr class="light">
<span class="subheader"> Arguments:</span>

   <span class="argumentLabel">A</span>                    <span class="argumentEntry">The type of buffer to configure:</span>

                        <span class="argumentEntry">  * 0 = left row buffer (for up/down pan)</span>
                        <span class="argumentEntry">        for the first 256 bytes of the 320-byte row</span>

                        <span class="argumentEntry">  * 1 = right row buffer (for up/down pan)</span>
                        <span class="argumentEntry">        for the last 64 bytes of the 320-byte row</span>

                        <span class="argumentEntry">  * 2 = column buffer (for left/right pan)</span>

</div></div>
<span class="label">.ConfigureBuffer</span><a id="configurebuffer" class="anchor"></a>

 <span class="mne">STA</span> <a class="popup variable">screenBufferType</a>   <span class="comment">\ Set screenBufferType to the new buffer type</span>

 <span class="mne">TAY</span>                    <span class="comment">\ Copy the buffer type into Y so we can use it as an</span>
                        <span class="comment">\ index into the various buffer configuration tables</span>

 <span class="mne">LDA</span> <a class="popup variable">buffersMinYaw</a>,<span class="register">Y</span>    <span class="comment">\ Set the high byte of bufferMinYaw(Hi Lo) to the value</span>
 <span class="mne">STA</span> <a class="popup variable">bufferMinYawHi</a>     <span class="comment">\ from the buffersMinYaw table for this screen buffer</span>

 <span class="mne">LSR</span> <span class="register">A</span>                  <span class="comment">\ Set bufferMaxYawHi = bufferMinYawHi / 2</span>
 <span class="mne">EOR</span> <span class="hash">#</span><span class="binary">%10000000</span>         <span class="comment">\</span>
 <span class="mne">STA</span> <a class="popup variable">bufferMaxYawHi</a>     <span class="comment">\ and with bit 7 flipped ???</span>

 <span class="mne">LDA</span> <a class="popup variable">buffersOrigin</a>,<span class="register">Y</span>    <span class="comment">\ Set the high byte of bufferOrigin(Hi Lo) to the value</span>
 <span class="mne">STA</span> <a class="popup variable">bufferOriginHi</a>     <span class="comment">\ from the buffersOrigin table for this screen buffer</span>

 <span class="mne">LDA</span> <a class="popup variable">xBuffersWidth</a>,<span class="register">Y</span>    <span class="comment">\ Set xBufferWidth to the value from the xBuffersWidth</span>
 <span class="mne">STA</span> <a class="popup variable">xBufferWidth</a>       <span class="comment">\ table for this screen buffer</span>

 <span class="mne">LDA</span> <a class="popup variable">xBuffersLeft</a>,<span class="register">Y</span>     <span class="comment">\ Set xBufferLeft to the value from the xBuffersLeft</span>
 <span class="mne">STA</span> <a class="popup variable">xBufferLeft</a>        <span class="comment">\ table for this screen buffer</span>

 <span class="mne">CLC</span>                    <span class="comment">\ Set xBufferRight = xBufferLeft + xBufferWidth</span>
 <span class="mne">ADC</span> <a class="popup variable">xBufferWidth</a>       <span class="comment">\</span>
 <span class="mne">STA</span> <a class="popup variable">xBufferRight</a>       <span class="comment">\ So this sets the right edge of the screen buffer</span>

 <span class="mne">LDA</span> <span class="hash">#</span><span class="decimal">0</span>                 <span class="comment">\ Zero the low byte of bufferMinYaw(Hi Lo)</span>
 <span class="mne">STA</span> <a class="popup variable">bufferMinYawLo</a>

 <span class="mne">STA</span> <a class="popup variable">bufferOriginLo</a>     <span class="comment">\ Zero the low byte of bufferOrigin(Hi Lo)</span>

 <span class="mne">RTS</span>                    <span class="comment">\ Return from the subroutine</span>
</pre>
				</div>

				<div class="codeBlockWrapper popupWrapper" id="popup-buffermaxyawhi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#buffermaxyawhi">bufferMaxYawHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The maximum allowed yaw angle for points in the current screen buffer (high byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-bufferminyawhi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#bufferminyawhi">bufferMinYawHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The minimum allowed yaw angle for points in the current screen buffer (high byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-bufferminyawlo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#bufferminyawlo">bufferMinYawLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The minimum allowed yaw angle for points in the current screen buffer (low byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-bufferoriginhi"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#bufferoriginhi">bufferOriginHi</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The offset to add to yaw angles for the current screen buffer to convert them from having the origin in the buffer centre to having the origin on the left edge of the buffer (high byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-bufferoriginlo"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#bufferoriginlo">bufferOriginLo</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The offset to add to yaw angles for the current screen buffer to convert them from having the origin in the buffer centre to having the origin on the left edge of the buffer (low byte)</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-buffersminyaw"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/buffersminyaw.html">buffersMinYaw</a> (category: Screen buffer)</div><div class="summary">Minimum allowed yaw angles for points in the screen buffer ???</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-buffersorigin"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/buffersorigin.html">buffersOrigin</a> (category: Screen buffer)</div><div class="summary">The offset to add to yaw angles for each screen buffer to convert from the origin in the buffer centre to the origin on the left</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-screenbuffertype"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#screenbuffertype">screenBufferType</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The type of screen buffer that is currently being used</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xbufferleft"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xbufferleft">xBufferLeft</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The left edge of the screen buffer in pixels</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xbufferright"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xbufferright">xBufferRight</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The right edge of the screen buffer in pixels</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xbufferwidth"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="name">Variable <a href="/source/main/workspace/zero_page.html#xbufferwidth">xBufferWidth</a> in workspace <a href="/source/main/workspace/zero_page.html">Zero page</a></div><div class="summary">The width in pixels of the screen buffer</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xbuffersleft"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/xbuffersleft.html">xBuffersLeft</a> (category: Screen buffer)</div><div class="summary">The left edge of each screen buffer in pixels ???</div></div></div></div>

				<div class="codeBlockWrapper popupWrapper" id="popup-xbufferswidth"><div class="codeBlock"><div class="close">[X]</div><div class="content"><div class="link">Variable <a href="/source/main/variable/xbufferswidth.html">xBuffersWidth</a> (category: Screen buffer)</div><div class="summary">The width of each screen buffer in pixels ???</div></div></div></div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous routine" href="/source/main/subroutine/flipbuffertype.html">FlipBufferType</a><a class="next" rel="next" title="Next routine" href="/source/main/variable/buffersorigin.html">buffersOrigin</a></nav>
				</div>
			</article>

<?php
include_once("../../../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
