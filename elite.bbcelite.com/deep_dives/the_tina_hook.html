<?php
include_once("../templates/template_functions.php");
page_header("deep_dives", "the_tina_hook.html", "The TINA hook", "The TINA hook", "A deep dive into the TINA hook in BBC Micro Elite", "elite", "deep_dives_6502sp_elite", "the_tina_hook");
?>
				<!-- Start of article -->
				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous deep dive" href="6502sp_demo_mode.html">The 6502 Second Processor demo mode</a><a class="next" rel="next" title="Next deep dive" href="secrets_of_the_executive_version.html">Secrets of the Executive version</a></nav>
				</div>

				<div class="codeBlockWrapper">
					<div class="codeBlock article">
						<h2 class="articleSubheader deepDive">Adding your own custom code to the 6502 Second Processor version using TINA</h2>

						<p>Programmers of the BBC Micro know all about SHEILA, FRED and JIM, and BBC Master coders are also friendly with LYNNE, HAZEL and ANDY. You don't get far in 6502 assembly language on the Acorn platforms without bumping into one of these important areas of memory, all of which map onto key parts of the system, from the 6522 VIA chips to the Master's shadow RAM. Acorn clearly liked their catchy nicknames.</p>

						<p>But the 6502 Second Processor version of Elite introduces a brand new character, TINA, and exactly what she does is a bit of a mystery. Sure, it's easy enough to track her down in the I/O processor's code - she's mentioned at the end of the <a href="/6502sp/i_o_processor/subroutine/startup.html#noint">STARTUP</a> routine, and <a href="/6502sp/i_o_processor/workspace/tina.html">TINA</a> herself is at &amp;0B00 - but what exactly does TINA do?</p>

						<p>It turns out she's quite simple, but quite powerful. If the contents of locations &amp;0B00 to &amp;0B03 contain the string "TINA" (in capital letters), then once the I/O processor code has finished setting up all the handlers for the <a href="/deep_dives/6502sp_tube_communication.html">Tube communication</a>, the code calls location &amp;0B04 with a JSR instruction. This allows us to add a hook to the start-up process by populating page &amp;B with "TINA" plus the code for a subroutine, and it will be called just before the setup code terminates on the I/O processor and the BBC Micro settles into listening for commands from the parasite.</p>

						<p>In this way, we could install a driver for some new piece of hardware, or set up an interrupt-driven routine to run in the background on the BBC Micro, all without changing the game code. All we need to do is store the code in &amp;0B00 with the "TINA" header, and it gets run automatically.</p>

						<p>I wonder what the original plans were for TINA, as there are no clues in the source code. It's intriguing stuff...</p>
					</div>
				</div>

				<div class="codeBlockWrapper nav">
					<nav class="codeBlock previousNext"><a class="previous" rel="prev" title="Previous deep dive" href="6502sp_demo_mode.html">The 6502 Second Processor demo mode</a><a class="next" rel="next" title="Next deep dive" href="secrets_of_the_executive_version.html">Secrets of the Executive version</a></nav>
				</div>
				<!-- End of article -->
			</article>

<?php
include_once("../templates_local/navigation.php");
?>
		</div>
	</body>
</html>
