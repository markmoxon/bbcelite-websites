Options -Indexes

ErrorDocument 404 /error_documents/missing.html
ErrorDocument 403 /error_documents/forbidden.html
ErrorDocument 402 /error_documents/failed_auth.html
ErrorDocument 500 /error_documents/internal_error.html

SetEnvIf Origin "https://(bbc.xania.org|xr.bbcmic.ro)$" AccessControlAllowOrigin=$0
Header add Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
Header merge Vary Origin

<IfModule mod_deflate.c>
	SetOutputFilter DEFLATE
	SetEnvIfNoCase Request_URI \.(gif|jpg|jpeg|png|zip|pdf|epub|kmz|mobi)$ no-gzip dont-vary
</IfModule>

<IfModule mod_expires.c>
	ExpiresActive On
	ExpiresDefault "access plus 2 days"
	<FilesMatch "\.(ico|gif|jpg|jpeg|png|flv|pdf|swf|mov|mp3|wmv|ppt)$">
		ExpiresDefault "access plus 1 year"
		Header append Cache-Control "public"
	</FilesMatch>
	<FilesMatch "\.(xml|txt|html|js|css)$">
		ExpiresDefault "access plus 1 month"
		Header append Cache-Control "private, must-revalidate"
	</FilesMatch>
	<FilesMatch "\.(php|cgi|pl)$">
		ExpiresDefault "access plus 0 seconds"
		Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
		Header set Pragma "no-cache"
	</FilesMatch>
</IfModule>

<IfModule mod_rewrite.c>
	RewriteEngine On
	#RewriteCond %{HTTPS} !=on
	#RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R=301,L]
	RewriteRule ^(css|css_local|javascript|javascript_local)(/|-)\d+/(.+)$ $1/$3 [L]

	#RewriteCond %{REQUEST_URI} ^/guestbook/viewforum\.php$
	#RewriteCond %{QUERY_STRING} ^.*f=([0-9]+).*start=([0-9]+).*$
	#RewriteRule ^.*$ /guestbook/forum/%1?start=%2 [R=301,S=1]

	#RewriteCond %{REQUEST_URI} ^/guestbook/viewforum\.php$
	#RewriteCond %{QUERY_STRING} ^.*f=([0-9]+).*$
	#RewriteRule ^.*$ /guestbook/forum/%1? [R=301]

	#RewriteCond %{REQUEST_URI} ^/guestbook/viewtopic\.php$
	#RewriteCond %{QUERY_STRING} ^.*t=([0-9]+).*start=([0-9]+).*$
	#RewriteRule ^.*$ /guestbook/topic/%1?start=%2 [R=301,S=1]

	#RewriteCond %{REQUEST_URI} ^/guestbook/viewtopic\.php$
	#RewriteCond %{QUERY_STRING} ^.*t=([0-9]+).*$
	#RewriteRule ^.*$ /guestbook/topic/%1? [R=301]

	#RewriteCond %{REQUEST_URI} ^/guestbook/posting\.php$
	#RewriteCond %{QUERY_STRING} ^.*mode=newtopic.*f=([0-9]+).*support=([0-9]+).*$
	#RewriteRule ^.*$ /guestbook/post/%1?support=%2 [R=301,S=1]

	#RewriteCond %{REQUEST_URI} ^/guestbook/posting\.php$
	#RewriteCond %{QUERY_STRING} ^.*mode=newtopic.*f=([0-9]+).*$
	#RewriteRule ^.*$ /guestbook/post/%1? [R=301]

	#RewriteCond %{REQUEST_URI} ^/guestbook/
	#RewriteRule ^guestbook/(.*)$ /guestbookapp/guestbook.fcgi/$1 [QSA,L]
	#RewriteCond %{REQUEST_URI} ^/guestbook$
	#RewriteRule ^guestbook$ /guestbookapp/guestbook.fcgi/ [QSA,L]

	RewriteCond %{REQUEST_URI} ^/tape/
	RewriteRule ^tape/(.*)$ /cassette/$1 [R=301,L]

	RewriteCond %{REQUEST_URI} ^/(cassette|disc|6502sp)/([^/]+)/(subroutine|variable|macro|workspace)_([^/]+)_(loader|loader_1|loader_2|loader_3|i_o_processor|docked|flight|big_code_file|text_tokens|missile_ship_blueprint|ship_blueprints_[a-p])\.html
	RewriteRule ^(cassette|disc|6502sp)/([^/]+)/(subroutine|variable|macro|workspace)_([^/]+)_(loader|loader_1|loader_2|loader_3|i_o_processor|docked|flight|big_code_file|text_tokens|missile_ship_blueprint|ship_blueprints_[a-p])\.html$ /$1/$5/$3/$4.html [R=301,L]

	RewriteCond %{REQUEST_URI} ^/(cassette|disc|6502sp)/([^/]+)/(subroutine|variable|macro|workspace)_([^/]+)\.html
	RewriteRule ^(cassette|disc|6502sp)/([^/]+)/(subroutine|variable|macro|workspace)_([^/]+)\.html$ /$1/main/$3/$4.html [R=301,L]

	RewriteCond %{REQUEST_URI} ^/compare/
	RewriteRule ^compare/$ /compare/versions_of_elite.html [R=301,L]
	RewriteRule ^compare/versions_of_elite.html$ /alias/compare/versions_of_elite.html [L,QSA]
	RewriteRule ^compare/releases.html$ /alias/compare/releases.html [L,QSA]
	RewriteRule ^compare/how_to_compare.html$ /alias/compare/how_to_compare.html [L,QSA]
	RewriteRule ^compare/feature_comparison.html$ /alias/compare/feature_comparison.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/6502sp/
	RewriteRule ^6502sp/$ /alias/6502sp/ [L,QSA]
	RewriteRule ^6502sp/releases.html$ /alias/6502sp/releases.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/cassette/
	RewriteRule ^cassette/$ /alias/cassette/ [L,QSA]
	RewriteRule ^cassette/releases.html$ /alias/cassette/releases.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/disc/
	RewriteRule ^disc/$ /alias/disc/ [L,QSA]
	RewriteRule ^disc/releases.html$ /alias/disc/releases.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/electron/
	RewriteRule ^electron/$ /alias/electron/ [L,QSA]
	RewriteRule ^electron/releases.html$ /alias/electron/releases.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/elite-a/
	RewriteRule ^elite-a/$ /alias/elite-a/ [L,QSA]
	RewriteRule ^elite-a/releases.html$ /alias/elite-a/releases.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/master/
	RewriteRule ^master/$ /alias/master/ [L,QSA]
	RewriteRule ^master/releases.html$ /alias/master/releases.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/nes/
	RewriteRule ^nes/$ /alias/nes/ [L,QSA]
	RewriteRule ^nes/releases.html$ /alias/nes/releases.html [L,QSA]
	RewriteCond %{REQUEST_URI} ^/playing_elite/
	RewriteRule ^playing_elite/$ /alias/playing_elite/ [L,QSA]

	RewriteCond %{REQUEST_URI} ^/terminology
	RewriteRule ^terminology/?$ /about_site/terminology_used_in_this_commentary.html [R=301,L]

	RewriteCond %{REQUEST_URI} ^(.*/)?index\.html?
	RewriteRule ^(.*/)?index\.html?$ /$1 [R=301,L]

	RewriteCond %{REQUEST_URI} ^(.*)//(.*)$ [NC]
	RewriteRule . %1/%2 [R=301,L]
</IfModule>

# Tell web browsers not to even try HTTP on this domain for the next year
Header set Strict-Transport-Security "max-age=31536000" env=HTTPS

<IfModule mod_mime.c>
	AddType application/x-httpd-php .php 			# Mac
	AddType application/x-httpd-php .html			# Mac
	#AddHandler fcgid-script .html					# Dreamhost
	#FcgidWrapper "/dh/cgi-system/php82.cgi" .html	# Dreamhost
	AddType text/x-component .htc
	AddType application/vnd.google-earth.kml+xml .kml
	AddType application/vnd.google-earth.kmz .kmz
	AddCharset UTF-8 .html
	AddCharset UTF-8 .php
	AddCharset UTF-8 .cgi
</IfModule>

<IfModule mod_alias.c>
	Redirect permanent /explore/indexes/a-z.html														https://www.bbcelite.com/cassette/indexes/a-z.html
	Redirect permanent /explore/indexes/workspaces.html													https://www.bbcelite.com/cassette/indexes/workspaces.html
	Redirect permanent /explore/indexes/macros.html														https://www.bbcelite.com/cassette/indexes/macros.html
	Redirect permanent /explore/indexes/subroutines.html												https://www.bbcelite.com/cassette/indexes/subroutines.html
	Redirect permanent /explore/indexes/variables.html													https://www.bbcelite.com/cassette/indexes/variables.html
	Redirect permanent /explore/indexes/deep_dives.html													https://www.bbcelite.com/deep_dives/
	Redirect permanent /explore/about_site/terminology_used_in_this_commentary.html						https://www.bbcelite.com/about_site/terminology_used_in_this_commentary.html
	Redirect permanent /explore/articles/map_of_the_source_code.html									https://www.bbcelite.com/cassette/articles/map_of_the_source_code.html
	Redirect permanent /explore/articles/source_code_cross-references.html								https://www.bbcelite.com/cassette/articles/source_code_cross-references.html
	Redirect permanent /explore/articles/source_code_statistics.html									https://www.bbcelite.com/cassette/articles/source_code_statistics.html
	Redirect permanent /explore/articles/deep_dive_the_3d_scanner.html									https://www.bbcelite.com/deep_dives/the_3d_scanner.html
	Redirect permanent /explore/articles/deep_dive_the_dashboard_indicators.html						https://www.bbcelite.com/deep_dives/the_dashboard_indicators.html
	Redirect permanent /explore/articles/deep_dive_drawing_circles.html									https://www.bbcelite.com/deep_dives/drawing_circles.html
	Redirect permanent /explore/articles/deep_dive_the_ball_line_heap.html								https://www.bbcelite.com/deep_dives/the_ball_line_heap.html
	Redirect permanent /explore/articles/deep_dive_bresenhams_line_algorithm.html						https://www.bbcelite.com/deep_dives/bresenhams_line_algorithm.html
	Redirect permanent /explore/articles/deep_dive_line-clipping.html									https://www.bbcelite.com/deep_dives/line-clipping.html
	Redirect permanent /explore/articles/deep_dive_drawing_colour_pixels_in_mode_5.html					https://www.bbcelite.com/deep_dives/drawing_colour_pixels_in_mode_5.html
	Redirect permanent /explore/articles/deep_dive_drawing_monochrome_pixels_in_mode_4.html				https://www.bbcelite.com/deep_dives/drawing_monochrome_pixels_in_mode_4.html
	Redirect permanent /explore/articles/deep_dive_extended_screen_coordinates.html						https://www.bbcelite.com/deep_dives/extended_screen_coordinates.html
	Redirect permanent /explore/articles/deep_dive_drawing_craters.html									https://www.bbcelite.com/deep_dives/drawing_craters.html
	Redirect permanent /explore/articles/deep_dive_drawing_meridians_and_equators.html					https://www.bbcelite.com/deep_dives/drawing_meridians_and_equators.html
	Redirect permanent /explore/articles/deep_dive_back-face_culling.html								https://www.bbcelite.com/deep_dives/back-face_culling.html
	Redirect permanent /explore/articles/deep_dive_calculating_vertex_coordinates.html					https://www.bbcelite.com/deep_dives/calculating_vertex_coordinates.html
	Redirect permanent /explore/articles/deep_dive_drawing_explosion_clouds.html						https://www.bbcelite.com/deep_dives/drawing_explosion_clouds.html
	Redirect permanent /explore/articles/deep_dive_drawing_ships.html									https://www.bbcelite.com/deep_dives/drawing_ships.html
	Redirect permanent /explore/articles/deep_dive_ship_blueprints.html									https://www.bbcelite.com/deep_dives/ship_blueprints.html
	Redirect permanent /explore/articles/deep_dive_drawing_the_sun.html									https://www.bbcelite.com/deep_dives/drawing_the_sun.html
	Redirect permanent /explore/articles/deep_dive_docking_checks.html									https://www.bbcelite.com/deep_dives/docking_checks.html
	Redirect permanent /explore/articles/deep_dive_flipping_axes_between_space_views.html				https://www.bbcelite.com/deep_dives/flipping_axes_between_space_views.html
	Redirect permanent /explore/articles/deep_dive_the_key_logger.html									https://www.bbcelite.com/deep_dives/the_key_logger.html
	Redirect permanent /explore/articles/deep_dive_program_flow_of_the_main_game_loop.html				https://www.bbcelite.com/deep_dives/program_flow_of_the_main_game_loop.html
	Redirect permanent /explore/articles/deep_dive_scheduling_tasks_with_the_main_loop_counter.html		https://www.bbcelite.com/deep_dives/scheduling_tasks_with_the_main_loop_counter.html
	Redirect permanent /explore/articles/deep_dive_the_elite_memory_map.html							https://www.bbcelite.com/deep_dives/the_elite_memory_map.html
	Redirect permanent /explore/articles/deep_dive_market_item_prices_and_availability.html				https://www.bbcelite.com/deep_dives/market_item_prices_and_availability.html
	Redirect permanent /explore/articles/deep_dive_adding_sign-magnitude_numbers.html					https://www.bbcelite.com/deep_dives/adding_sign-magnitude_numbers.html
	Redirect permanent /explore/articles/deep_dive_calculating_square_roots.html						https://www.bbcelite.com/deep_dives/calculating_square_roots.html
	Redirect permanent /explore/articles/deep_dive_shift-and-add_multiplication.html					https://www.bbcelite.com/deep_dives/shift-and-add_multiplication.html
	Redirect permanent /explore/articles/deep_dive_shift-and-subtract_division.html						https://www.bbcelite.com/deep_dives/shift-and-subtract_division.html
	Redirect permanent /explore/articles/deep_dive_the_sine_cosine_and_arctan_tables.html				https://www.bbcelite.com/deep_dives/the_sine_cosine_and_arctan_tables.html
	Redirect permanent /explore/articles/deep_dive_orientation_vectors.html								https://www.bbcelite.com/deep_dives/orientation_vectors.html
	Redirect permanent /explore/articles/deep_dive_pitching_and_rolling.html							https://www.bbcelite.com/deep_dives/pitching_and_rolling.html
	Redirect permanent /explore/articles/deep_dive_pitching_and_rolling_by_a_fixed_angle.html			https://www.bbcelite.com/deep_dives/pitching_and_rolling_by_a_fixed_angle.html
	Redirect permanent /explore/articles/deep_dive_program_flow_of_the_ship-moving_routine.html			https://www.bbcelite.com/deep_dives/program_flow_of_the_ship-moving_routine.html
	Redirect permanent /explore/articles/deep_dive_rotating_the_universe.html							https://www.bbcelite.com/deep_dives/rotating_the_universe.html
	Redirect permanent /explore/articles/deep_dive_tidying_orthonormal_vectors.html						https://www.bbcelite.com/deep_dives/tidying_orthonormal_vectors.html
	Redirect permanent /explore/articles/deep_dive_the_competition_code.html							https://www.bbcelite.com/deep_dives/the_competition_code.html
	Redirect permanent /explore/articles/deep_dive_the_split-screen_mode.html							https://www.bbcelite.com/deep_dives/the_split-screen_mode.html
	Redirect permanent /explore/articles/deep_dive_stardust_in_the_front_view.html						https://www.bbcelite.com/deep_dives/stardust_in_the_front_view.html
	Redirect permanent /explore/articles/deep_dive_stardust_in_the_side_views.html						https://www.bbcelite.com/deep_dives/stardust_in_the_side_views.html
	Redirect permanent /explore/articles/deep_dive_in_the_crosshairs.html								https://www.bbcelite.com/deep_dives/in_the_crosshairs.html
	Redirect permanent /explore/articles/deep_dive_program_flow_of_the_tactics_routine.html				https://www.bbcelite.com/deep_dives/program_flow_of_the_tactics_routine.html
	Redirect permanent /explore/articles/deep_dive_printing_decimal_numbers.html						https://www.bbcelite.com/deep_dives/printing_decimal_numbers.html
	Redirect permanent /explore/articles/deep_dive_printing_text_tokens.html							https://www.bbcelite.com/deep_dives/printing_text_tokens.html
	Redirect permanent /explore/articles/deep_dive_galaxy_and_system_seeds.html							https://www.bbcelite.com/deep_dives/galaxy_and_system_seeds.html
	Redirect permanent /explore/articles/deep_dive_generating_system_data.html							https://www.bbcelite.com/deep_dives/generating_system_data.html
	Redirect permanent /explore/articles/deep_dive_generating_system_names.html							https://www.bbcelite.com/deep_dives/generating_system_names.html
	Redirect permanent /explore/articles/deep_dive_ship_data_blocks.html								https://www.bbcelite.com/deep_dives/ship_data_blocks.html
	Redirect permanent /explore/articles/deep_dive_the_local_bubble_of_universe.html					https://www.bbcelite.com/deep_dives/the_local_bubble_of_universe.html
	Redirect permanent /explore/articles/deep_dive_twisting_the_system_seeds.html						https://www.bbcelite.com/deep_dives/twisting_the_system_seeds.html
	Redirect permanent /explore/articles/deep_dive_generating_random_numbers.html						https://www.bbcelite.com/deep_dives/generating_random_numbers.html
	Redirect permanent /about_site/how_to_compare_versions.html											https://www.bbcelite.com/compare/how_to_compare_versions.html
	Redirect permanent /about_site/feature_comparison.html												https://www.bbcelite.com/compare/feature_comparison.html
	Redirect permanent /about_site/versions_of_elite.html												https://www.bbcelite.com/compare/versions_of_elite.html
	Redirect permanent /versions/flicker_free_elite/elite-cassette-flicker-free.ssd						https://www.bbcelite.com/versions/flicker_free_elite/elite-cassette-flicker-free-from-source-disc.ssd
	Redirect permanent /versions/flicker_free_elite/elite-disc-flicker-free.ssd						    https://www.bbcelite.com/versions/flicker_free_elite/elite-disc-flicker-free-sth.ssd
	Redirect permanent /versions/flicker_free_elite/elite-electron-flicker-free.ssd						https://www.bbcelite.com/versions/flicker_free_elite/elite-electron-flicker-free-ib-superior.ssd
	Redirect permanent /versions/elite/elite-electron-egg.ssd											https://www.bbcelite.com/versions/elite/elite-electron-ib-superior.ssd
	Redirect permanent /versions/elite/elite-electron-egg.uef											https://www.bbcelite.com/versions/elite/elite-electron-ib-superior.uef
	Redirect permanent /versions/flicker_free_elite/elite-electron-flicker-free-egg.ssd					https://www.bbcelite.com/versions/flicker_free_elite/elite-electron-flicker-free-ib-superior.ssd
	Redirect permanent /versions/flicker_free_elite/elite-electron-flicker-free-egg.uef					https://www.bbcelite.com/versions/flicker_free_elite/elite-electron-flicker-free-ib-superior.uef
	Redirect permanent /versions/elite_universe_editor/elite-universe-editor.ssd						https://www.bbcelite.com/versions/elite_universe_editor/elite-universe-editor-bbc.ssd
	Redirect permanent /disc/flight/subroutine/lships.html												https://www.bbcelite.com/disc/flight/subroutine/lomod.html
</IfModule>
